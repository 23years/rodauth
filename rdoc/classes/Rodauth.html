<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Rodauth</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Rodauth
</h1>
<ol class='paths'>
<li>
<a href="../files/lib/rodauth_rb.html">lib/rodauth.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/account_expiration_rb.html">lib/rodauth/features/account_expiration.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/base_rb.html">lib/rodauth/features/base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/change_login_rb.html">lib/rodauth/features/change_login.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/change_password_rb.html">lib/rodauth/features/change_password.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/change_password_notify_rb.html">lib/rodauth/features/change_password_notify.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/close_account_rb.html">lib/rodauth/features/close_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/confirm_password_rb.html">lib/rodauth/features/confirm_password.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/create_account_rb.html">lib/rodauth/features/create_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/disallow_common_passwords_rb.html">lib/rodauth/features/disallow_common_passwords.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/disallow_password_reuse_rb.html">lib/rodauth/features/disallow_password_reuse.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/email_auth_rb.html">lib/rodauth/features/email_auth.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/email_base_rb.html">lib/rodauth/features/email_base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/http_basic_auth_rb.html">lib/rodauth/features/http_basic_auth.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/jwt_rb.html">lib/rodauth/features/jwt.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/lockout_rb.html">lib/rodauth/features/lockout.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/login_rb.html">lib/rodauth/features/login.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/login_password_requirements_base_rb.html">lib/rodauth/features/login_password_requirements_base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/logout_rb.html">lib/rodauth/features/logout.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/otp_rb.html">lib/rodauth/features/otp.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_complexity_rb.html">lib/rodauth/features/password_complexity.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_expiration_rb.html">lib/rodauth/features/password_expiration.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_grace_period_rb.html">lib/rodauth/features/password_grace_period.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/recovery_codes_rb.html">lib/rodauth/features/recovery_codes.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/remember_rb.html">lib/rodauth/features/remember.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/reset_password_rb.html">lib/rodauth/features/reset_password.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/session_expiration_rb.html">lib/rodauth/features/session_expiration.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/single_session_rb.html">lib/rodauth/features/single_session.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/sms_codes_rb.html">lib/rodauth/features/sms_codes.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/two_factor_base_rb.html">lib/rodauth/features/two_factor_base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/update_password_hash_rb.html">lib/rodauth/features/update_password_hash.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_account_rb.html">lib/rodauth/features/verify_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_account_grace_period_rb.html">lib/rodauth/features/verify_account_grace_period.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_change_login_rb.html">lib/rodauth/features/verify_change_login.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_login_change_rb.html">lib/rodauth/features/verify_login_change.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/migrations_rb.html">lib/rodauth/migrations.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/version_rb.html">lib/rodauth/version.rb</a>
</li>
<li>
<a class='show' href='#' onclick='this.parentNode.parentNode.className += &quot; expanded&quot;; this.parentNode.removeChild(this); return false'>show all</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'></div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-configure">configure</a></li>
<li><a href="#method-c-create_database_authentication_functions">create_database_authentication_functions</a></li>
<li><a href="#method-c-create_database_previous_password_check_functions">create_database_previous_password_check_functions</a></li>
<li><a href="#method-c-drop_database_authentication_functions">drop_database_authentication_functions</a></li>
<li><a href="#method-c-drop_database_previous_password_check_functions">drop_database_previous_password_check_functions</a></li>
<li><a href="#method-c-load_dependencies">load_dependencies</a></li>
<li><a href="#method-c-new">new</a></li>
<li><a href="#method-c-version">version</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-_account_from_email_auth_key">_account_from_email_auth_key</a></li>
<li><a href="#method-i-_account_from_login">_account_from_login</a></li>
<li><a href="#method-i-_account_from_reset_password_key">_account_from_reset_password_key</a></li>
<li><a href="#method-i-_account_from_session">_account_from_session</a></li>
<li><a href="#method-i-_account_from_unlock_key">_account_from_unlock_key</a></li>
<li><a href="#method-i-_account_from_verify_account_key">_account_from_verify_account_key</a></li>
<li><a href="#method-i-_account_from_verify_login_change_key">_account_from_verify_login_change_key</a></li>
<li><a href="#method-i-_email_auth_request">_email_auth_request</a></li>
<li><a href="#method-i-_json_response_body">_json_response_body</a></li>
<li><a href="#method-i-_login">_login</a></li>
<li><a href="#method-i-_new_account">_new_account</a></li>
<li><a href="#method-i-_otp">_otp</a></li>
<li><a href="#method-i-_otp_add_key">_otp_add_key</a></li>
<li><a href="#method-i-_otp_key">_otp_key</a></li>
<li><a href="#method-i-_otp_tmp_key">_otp_tmp_key</a></li>
<li><a href="#method-i-_recovery_codes">_recovery_codes</a></li>
<li><a href="#method-i-_sms">_sms</a></li>
<li><a href="#method-i-_two_factor_auth_required_redirect">_two_factor_auth_required_redirect</a></li>
<li><a href="#method-i-_update_login">_update_login</a></li>
<li><a href="#method-i-_view">_view</a></li>
<li><a href="#method-i-_view_opts">_view_opts</a></li>
<li><a href="#method-i-account_activity_ds">account_activity_ds</a></li>
<li><a href="#method-i-account_ds">account_ds</a></li>
<li><a href="#method-i-account_expired-3F">account_expired?</a></li>
<li><a href="#method-i-account_expired_at">account_expired_at</a></li>
<li><a href="#method-i-account_from_email_auth_key">account_from_email_auth_key</a></li>
<li><a href="#method-i-account_from_key">account_from_key</a></li>
<li><a href="#method-i-account_from_login">account_from_login</a></li>
<li><a href="#method-i-account_from_reset_password_key">account_from_reset_password_key</a></li>
<li><a href="#method-i-account_from_session">account_from_session</a></li>
<li><a href="#method-i-account_from_unlock_key">account_from_unlock_key</a></li>
<li><a href="#method-i-account_from_verify_account_key">account_from_verify_account_key</a></li>
<li><a href="#method-i-account_from_verify_login_change_key">account_from_verify_login_change_key</a></li>
<li><a href="#method-i-account_id">account_id</a></li>
<li><a href="#method-i-account_in_unverified_grace_period-3F">account_in_unverified_grace_period?</a></li>
<li><a href="#method-i-account_initial_status_value">account_initial_status_value</a></li>
<li><a href="#method-i-account_lockouts_ds">account_lockouts_ds</a></li>
<li><a href="#method-i-account_login_failures_ds">account_login_failures_ds</a></li>
<li><a href="#method-i-account_model">account_model</a></li>
<li><a href="#method-i-account_password_hash_column">account_password_hash_column</a></li>
<li><a href="#method-i-account_session_status_filter">account_session_status_filter</a></li>
<li><a href="#method-i-active_remember_key_ds">active_remember_key_ds</a></li>
<li><a href="#method-i-add_previous_password_hash">add_previous_password_hash</a></li>
<li><a href="#method-i-add_recovery_code">add_recovery_code</a></li>
<li><a href="#method-i-add_recovery_codes">add_recovery_codes</a></li>
<li><a href="#method-i-add_remember_key">add_remember_key</a></li>
<li><a href="#method-i-after_change_login">after_change_login</a></li>
<li><a href="#method-i-after_change_password">after_change_password</a></li>
<li><a href="#method-i-after_close_account">after_close_account</a></li>
<li><a href="#method-i-after_confirm_password">after_confirm_password</a></li>
<li><a href="#method-i-after_create_account">after_create_account</a></li>
<li><a href="#method-i-after_login">after_login</a></li>
<li><a href="#method-i-after_login_entered_during_multi_phase_login">after_login_entered_during_multi_phase_login</a></li>
<li><a href="#method-i-after_login_failure">after_login_failure</a></li>
<li><a href="#method-i-after_logout">after_logout</a></li>
<li><a href="#method-i-after_reset_password">after_reset_password</a></li>
<li><a href="#method-i-allow_resending_verify_account_email-3F">allow_resending_verify_account_email?</a></li>
<li><a href="#method-i-already_logged_in">already_logged_in</a></li>
<li><a href="#method-i-auth_class_eval">auth_class_eval</a></li>
<li><a href="#method-i-authenticated-3F">authenticated?</a></li>
<li><a href="#method-i-before_change_login_route">before_change_login_route</a></li>
<li><a href="#method-i-before_change_password_route">before_change_password_route</a></li>
<li><a href="#method-i-before_login_attempt">before_login_attempt</a></li>
<li><a href="#method-i-before_logout">before_logout</a></li>
<li><a href="#method-i-before_otp_authentication_route">before_otp_authentication_route</a></li>
<li><a href="#method-i-before_reset_password">before_reset_password</a></li>
<li><a href="#method-i-before_reset_password_request">before_reset_password_request</a></li>
<li><a href="#method-i-before_rodauth">before_rodauth</a></li>
<li><a href="#method-i-before_unlock_account">before_unlock_account</a></li>
<li><a href="#method-i-before_unlock_account_request">before_unlock_account_request</a></li>
<li><a href="#method-i-before_view_recovery_codes">before_view_recovery_codes</a></li>
<li><a href="#method-i-button">button</a></li>
<li><a href="#method-i-button_opts">button_opts</a></li>
<li><a href="#method-i-can_add_recovery_codes-3F">can_add_recovery_codes?</a></li>
<li><a href="#method-i-catch_error">catch_error</a></li>
<li><a href="#method-i-change_login">change_login</a></li>
<li><a href="#method-i-change_login_notice_flash">change_login_notice_flash</a></li>
<li><a href="#method-i-change_login_requires_password-3F">change_login_requires_password?</a></li>
<li><a href="#method-i-change_password_requires_password-3F">change_password_requires_password?</a></li>
<li><a href="#method-i-check_account_expiration">check_account_expiration</a></li>
<li><a href="#method-i-check_already_logged_in">check_already_logged_in</a></li>
<li><a href="#method-i-check_password_change_allowed">check_password_change_allowed</a></li>
<li><a href="#method-i-check_session_expiration">check_session_expiration</a></li>
<li><a href="#method-i-check_single_session">check_single_session</a></li>
<li><a href="#method-i-clear_cached_otp">clear_cached_otp</a></li>
<li><a href="#method-i-clear_invalid_login_attempts">clear_invalid_login_attempts</a></li>
<li><a href="#method-i-clear_remembered_session_key">clear_remembered_session_key</a></li>
<li><a href="#method-i-clear_session">clear_session</a></li>
<li><a href="#method-i-close_account">close_account</a></li>
<li><a href="#method-i-close_account_requires_password-3F">close_account_requires_password?</a></li>
<li><a href="#method-i-confirm_password">confirm_password</a></li>
<li><a href="#method-i-confirm_password_redirect">confirm_password_redirect</a></li>
<li><a href="#method-i-convert_session_key">convert_session_key</a></li>
<li><a href="#method-i-convert_timestamp">convert_timestamp</a></li>
<li><a href="#method-i-create_account_autologin-3F">create_account_autologin?</a></li>
<li><a href="#method-i-create_account_link">create_account_link</a></li>
<li><a href="#method-i-create_account_notice_flash">create_account_notice_flash</a></li>
<li><a href="#method-i-create_account_set_password-3F">create_account_set_password?</a></li>
<li><a href="#method-i-create_email">create_email</a></li>
<li><a href="#method-i-create_email_auth_email">create_email_auth_email</a></li>
<li><a href="#method-i-create_email_auth_key">create_email_auth_key</a></li>
<li><a href="#method-i-create_email_to">create_email_to</a></li>
<li><a href="#method-i-create_password_changed_email">create_password_changed_email</a></li>
<li><a href="#method-i-create_reset_password_email">create_reset_password_email</a></li>
<li><a href="#method-i-create_reset_password_key">create_reset_password_key</a></li>
<li><a href="#method-i-create_unlock_account_email">create_unlock_account_email</a></li>
<li><a href="#method-i-create_verify_account_email">create_verify_account_email</a></li>
<li><a href="#method-i-create_verify_account_key">create_verify_account_key</a></li>
<li><a href="#method-i-create_verify_login_change_email">create_verify_login_change_email</a></li>
<li><a href="#method-i-create_verify_login_change_key">create_verify_login_change_key</a></li>
<li><a href="#method-i-csrf_tag">csrf_tag</a></li>
<li><a href="#method-i-currently_active_session-3F">currently_active_session?</a></li>
<li><a href="#method-i-db">db</a></li>
<li><a href="#method-i-delete_account">delete_account</a></li>
<li><a href="#method-i-delete_account_on_close-3F">delete_account_on_close?</a></li>
<li><a href="#method-i-disable_remember_login">disable_remember_login</a></li>
<li><a href="#method-i-email_auth_ds">email_auth_ds</a></li>
<li><a href="#method-i-email_auth_email_body">email_auth_email_body</a></li>
<li><a href="#method-i-email_auth_email_link">email_auth_email_link</a></li>
<li><a href="#method-i-email_auth_email_recently_sent-3F">email_auth_email_recently_sent?</a></li>
<li><a href="#method-i-email_auth_key_insert_hash">email_auth_key_insert_hash</a></li>
<li><a href="#method-i-email_auth_request_form">email_auth_request_form</a></li>
<li><a href="#method-i-email_from">email_from</a></li>
<li><a href="#method-i-email_to">email_to</a></li>
<li><a href="#method-i-expire_session">expire_session</a></li>
<li><a href="#method-i-features">features</a></li>
<li><a href="#method-i-field_error">field_error</a></li>
<li><a href="#method-i-flash">flash</a></li>
<li><a href="#method-i-force_email_auth-3F">force_email_auth?</a></li>
<li><a href="#method-i-forget_login">forget_login</a></li>
<li><a href="#method-i-function_name">function_name</a></li>
<li><a href="#method-i-generate_email_auth_key_value">generate_email_auth_key_value</a></li>
<li><a href="#method-i-generate_remember_key_value">generate_remember_key_value</a></li>
<li><a href="#method-i-generate_reset_password_key_value">generate_reset_password_key_value</a></li>
<li><a href="#method-i-generate_unlock_account_key">generate_unlock_account_key</a></li>
<li><a href="#method-i-generate_verify_account_key_value">generate_verify_account_key_value</a></li>
<li><a href="#method-i-generate_verify_login_change_key_value">generate_verify_login_change_key_value</a></li>
<li><a href="#method-i-get_activity_timestamp">get_activity_timestamp</a></li>
<li><a href="#method-i-get_email_auth_email_last_sent">get_email_auth_email_last_sent</a></li>
<li><a href="#method-i-get_email_auth_key">get_email_auth_key</a></li>
<li><a href="#method-i-get_password_changed_at">get_password_changed_at</a></li>
<li><a href="#method-i-get_password_hash">get_password_hash</a></li>
<li><a href="#method-i-get_password_reset_key">get_password_reset_key</a></li>
<li><a href="#method-i-get_remember_key">get_remember_key</a></li>
<li><a href="#method-i-get_reset_password_email_last_sent">get_reset_password_email_last_sent</a></li>
<li><a href="#method-i-get_unlock_account_email_last_sent">get_unlock_account_email_last_sent</a></li>
<li><a href="#method-i-get_unlock_account_key">get_unlock_account_key</a></li>
<li><a href="#method-i-get_verify_account_email_last_sent">get_verify_account_email_last_sent</a></li>
<li><a href="#method-i-get_verify_account_key">get_verify_account_key</a></li>
<li><a href="#method-i-get_verify_login_change_login_and_key">get_verify_login_change_login_and_key</a></li>
<li><a href="#method-i-include_success_messages-3F">include_success_messages?</a></li>
<li><a href="#method-i-invalid_login_attempted">invalid_login_attempted</a></li>
<li><a href="#method-i-invalid_previous_password_message">invalid_previous_password_message</a></li>
<li><a href="#method-i-json_request-3F">json_request?</a></li>
<li><a href="#method-i-json_response">json_response</a></li>
<li><a href="#method-i-jwt_payload">jwt_payload</a></li>
<li><a href="#method-i-jwt_secret">jwt_secret</a></li>
<li><a href="#method-i-jwt_session_hash">jwt_session_hash</a></li>
<li><a href="#method-i-jwt_token">jwt_token</a></li>
<li><a href="#method-i-last_account_activity_at">last_account_activity_at</a></li>
<li><a href="#method-i-last_account_login_at">last_account_login_at</a></li>
<li><a href="#method-i-load_memory">load_memory</a></li>
<li><a href="#method-i-loaded_templates">loaded_templates</a></li>
<li><a href="#method-i-locked_out-3F">locked_out?</a></li>
<li><a href="#method-i-logged_in_via_remember_key-3F">logged_in_via_remember_key?</a></li>
<li><a href="#method-i-login_confirm_label">login_confirm_label</a></li>
<li><a href="#method-i-login_does_not_meet_requirements_message">login_does_not_meet_requirements_message</a></li>
<li><a href="#method-i-login_failed_reset_password_request_form">login_failed_reset_password_request_form</a></li>
<li><a href="#method-i-login_form_footer">login_form_footer</a></li>
<li><a href="#method-i-login_hidden_field">login_hidden_field</a></li>
<li><a href="#method-i-login_meets_email_requirements-3F">login_meets_email_requirements?</a></li>
<li><a href="#method-i-login_meets_length_requirements-3F">login_meets_length_requirements?</a></li>
<li><a href="#method-i-login_meets_requirements-3F">login_meets_requirements?</a></li>
<li><a href="#method-i-login_required">login_required</a></li>
<li><a href="#method-i-login_too_long_message">login_too_long_message</a></li>
<li><a href="#method-i-login_too_short_message">login_too_short_message</a></li>
<li><a href="#method-i-logout">logout</a></li>
<li><a href="#method-i-modifications_require_password-3F">modifications_require_password?</a></li>
<li><a href="#method-i-new_account">new_account</a></li>
<li><a href="#method-i-new_recovery_code">new_recovery_code</a></li>
<li><a href="#method-i-no_longer_active_session">no_longer_active_session</a></li>
<li><a href="#method-i-only_json-3F">only_json?</a></li>
<li><a href="#method-i-open_account-3F">open_account?</a></li>
<li><a href="#method-i-otp_add_key">otp_add_key</a></li>
<li><a href="#method-i-otp_auth_form_footer">otp_auth_form_footer</a></li>
<li><a href="#method-i-otp_exists-3F">otp_exists?</a></li>
<li><a href="#method-i-otp_issuer">otp_issuer</a></li>
<li><a href="#method-i-otp_key_ds">otp_key_ds</a></li>
<li><a href="#method-i-otp_locked_out-3F">otp_locked_out?</a></li>
<li><a href="#method-i-otp_lockout_error_flash">otp_lockout_error_flash</a></li>
<li><a href="#method-i-otp_lockout_redirect">otp_lockout_redirect</a></li>
<li><a href="#method-i-otp_new_secret">otp_new_secret</a></li>
<li><a href="#method-i-otp_provisioning_name">otp_provisioning_name</a></li>
<li><a href="#method-i-otp_provisioning_uri">otp_provisioning_uri</a></li>
<li><a href="#method-i-otp_qr_code">otp_qr_code</a></li>
<li><a href="#method-i-otp_record_authentication_failure">otp_record_authentication_failure</a></li>
<li><a href="#method-i-otp_remove">otp_remove</a></li>
<li><a href="#method-i-otp_remove_auth_failures">otp_remove_auth_failures</a></li>
<li><a href="#method-i-otp_tmp_key">otp_tmp_key</a></li>
<li><a href="#method-i-otp_update_last_use">otp_update_last_use</a></li>
<li><a href="#method-i-otp_valid_code-3F">otp_valid_code?</a></li>
<li><a href="#method-i-otp_valid_key-3F">otp_valid_key?</a></li>
<li><a href="#method-i-param">param</a></li>
<li><a href="#method-i-param_or_nil">param_or_nil</a></li>
<li><a href="#method-i-password_changed_email_body">password_changed_email_body</a></li>
<li><a href="#method-i-password_confirm_label">password_confirm_label</a></li>
<li><a href="#method-i-password_does_not_contain_null_byte-3F">password_does_not_contain_null_byte?</a></li>
<li><a href="#method-i-password_does_not_meet_requirements_message">password_does_not_meet_requirements_message</a></li>
<li><a href="#method-i-password_doesnt_match_previous_password-3F">password_doesnt_match_previous_password?</a></li>
<li><a href="#method-i-password_expiration_ds">password_expiration_ds</a></li>
<li><a href="#method-i-password_expired-3F">password_expired?</a></li>
<li><a href="#method-i-password_has_enough_character_groups-3F">password_has_enough_character_groups?</a></li>
<li><a href="#method-i-password_has_no_invalid_pattern-3F">password_has_no_invalid_pattern?</a></li>
<li><a href="#method-i-password_hash">password_hash</a></li>
<li><a href="#method-i-password_hash_cost">password_hash_cost</a></li>
<li><a href="#method-i-password_hash_ds">password_hash_ds</a></li>
<li><a href="#method-i-password_match-3F">password_match?</a></li>
<li><a href="#method-i-password_meets_length_requirements-3F">password_meets_length_requirements?</a></li>
<li><a href="#method-i-password_meets_requirements-3F">password_meets_requirements?</a></li>
<li><a href="#method-i-password_not_in_dictionary-3F">password_not_in_dictionary?</a></li>
<li><a href="#method-i-password_not_one_of_the_most_common-3F">password_not_one_of_the_most_common?</a></li>
<li><a href="#method-i-password_not_too_many_repeating_characters-3F">password_not_too_many_repeating_characters?</a></li>
<li><a href="#method-i-password_one_of_most_common-3F">password_one_of_most_common?</a></li>
<li><a href="#method-i-password_recently_entered-3F">password_recently_entered?</a></li>
<li><a href="#method-i-password_reset_ds">password_reset_ds</a></li>
<li><a href="#method-i-password_too_many_repeating_characters_message">password_too_many_repeating_characters_message</a></li>
<li><a href="#method-i-password_too_short_message">password_too_short_message</a></li>
<li><a href="#method-i-post_configure">post_configure</a></li>
<li><a href="#method-i-previous_password_ds">previous_password_ds</a></li>
<li><a href="#method-i-raises_uniqueness_violation-3F">raises_uniqueness_violation?</a></li>
<li><a href="#method-i-random_key">random_key</a></li>
<li><a href="#method-i-recovery_code_match-3F">recovery_code_match?</a></li>
<li><a href="#method-i-recovery_codes_ds">recovery_codes_ds</a></li>
<li><a href="#method-i-recovery_codes_primary-3F">recovery_codes_primary?</a></li>
<li><a href="#method-i-recovery_codes_remove">recovery_codes_remove</a></li>
<li><a href="#method-i-redirect">redirect</a></li>
<li><a href="#method-i-remember_key_ds">remember_key_ds</a></li>
<li><a href="#method-i-remember_login">remember_login</a></li>
<li><a href="#method-i-remove_email_auth_key">remove_email_auth_key</a></li>
<li><a href="#method-i-remove_lockout_metadata">remove_lockout_metadata</a></li>
<li><a href="#method-i-remove_remember_key">remove_remember_key</a></li>
<li><a href="#method-i-remove_reset_password_key">remove_reset_password_key</a></li>
<li><a href="#method-i-remove_verify_account_key">remove_verify_account_key</a></li>
<li><a href="#method-i-remove_verify_login_change_key">remove_verify_login_change_key</a></li>
<li><a href="#method-i-render">render</a></li>
<li><a href="#method-i-request">request</a></li>
<li><a href="#method-i-require_account">require_account</a></li>
<li><a href="#method-i-require_account_session">require_account_session</a></li>
<li><a href="#method-i-require_authentication">require_authentication</a></li>
<li><a href="#method-i-require_current_password">require_current_password</a></li>
<li><a href="#method-i-require_login">require_login</a></li>
<li><a href="#method-i-require_otp_setup">require_otp_setup</a></li>
<li><a href="#method-i-require_sms_available">require_sms_available</a></li>
<li><a href="#method-i-require_sms_not_setup">require_sms_not_setup</a></li>
<li><a href="#method-i-require_sms_setup">require_sms_setup</a></li>
<li><a href="#method-i-require_two_factor_authenticated">require_two_factor_authenticated</a></li>
<li><a href="#method-i-require_two_factor_not_authenticated">require_two_factor_not_authenticated</a></li>
<li><a href="#method-i-require_two_factor_setup">require_two_factor_setup</a></li>
<li><a href="#method-i-reset_password_email_body">reset_password_email_body</a></li>
<li><a href="#method-i-reset_password_email_link">reset_password_email_link</a></li>
<li><a href="#method-i-reset_password_email_recently_sent-3F">reset_password_email_recently_sent?</a></li>
<li><a href="#method-i-reset_password_key_insert_hash">reset_password_key_insert_hash</a></li>
<li><a href="#method-i-reset_password_request_link">reset_password_request_link</a></li>
<li><a href="#method-i-reset_single_session_key">reset_single_session_key</a></li>
<li><a href="#method-i-response">response</a></li>
<li><a href="#method-i-retry_on_uniqueness_violation">retry_on_uniqueness_violation</a></li>
<li><a href="#method-i-return_json_response">return_json_response</a></li>
<li><a href="#method-i-route-21">route!</a></li>
<li><a href="#method-i-save_account">save_account</a></li>
<li><a href="#method-i-send_email_auth_email">send_email_auth_email</a></li>
<li><a href="#method-i-send_password_changed_email">send_password_changed_email</a></li>
<li><a href="#method-i-send_reset_password_email">send_reset_password_email</a></li>
<li><a href="#method-i-send_unlock_account_email">send_unlock_account_email</a></li>
<li><a href="#method-i-send_verify_account_email">send_verify_account_email</a></li>
<li><a href="#method-i-send_verify_login_change_email">send_verify_login_change_email</a></li>
<li><a href="#method-i-session">session</a></li>
<li><a href="#method-i-session_expiration_redirect">session_expiration_redirect</a></li>
<li><a href="#method-i-session_jwt">session_jwt</a></li>
<li><a href="#method-i-session_value">session_value</a></li>
<li><a href="#method-i-set_deadline_value">set_deadline_value</a></li>
<li><a href="#method-i-set_deadline_values-3F">set_deadline_values?</a></li>
<li><a href="#method-i-set_email_auth_email_last_sent">set_email_auth_email_last_sent</a></li>
<li><a href="#method-i-set_error_flash">set_error_flash</a></li>
<li><a href="#method-i-set_expired">set_expired</a></li>
<li><a href="#method-i-set_field_error">set_field_error</a></li>
<li><a href="#method-i-set_http_basic_auth_error_response">set_http_basic_auth_error_response</a></li>
<li><a href="#method-i-set_jwt">set_jwt</a></li>
<li><a href="#method-i-set_jwt_token">set_jwt_token</a></li>
<li><a href="#method-i-set_last_password_entry">set_last_password_entry</a></li>
<li><a href="#method-i-set_new_account_password">set_new_account_password</a></li>
<li><a href="#method-i-set_notice_flash">set_notice_flash</a></li>
<li><a href="#method-i-set_notice_now_flash">set_notice_now_flash</a></li>
<li><a href="#method-i-set_password">set_password</a></li>
<li><a href="#method-i-set_redirect_error_flash">set_redirect_error_flash</a></li>
<li><a href="#method-i-set_redirect_error_status">set_redirect_error_status</a></li>
<li><a href="#method-i-set_reset_password_email_last_sent">set_reset_password_email_last_sent</a></li>
<li><a href="#method-i-set_response_error_status">set_response_error_status</a></li>
<li><a href="#method-i-set_session_value">set_session_value</a></li>
<li><a href="#method-i-set_title">set_title</a></li>
<li><a href="#method-i-set_unlock_account_email_last_sent">set_unlock_account_email_last_sent</a></li>
<li><a href="#method-i-set_verify_account_email_last_sent">set_verify_account_email_last_sent</a></li>
<li><a href="#method-i-setup_account_verification">setup_account_verification</a></li>
<li><a href="#method-i-show_lockout_page">show_lockout_page</a></li>
<li><a href="#method-i-single_session_ds">single_session_ds</a></li>
<li><a href="#method-i-skip_login_field_on_login-3F">skip_login_field_on_login?</a></li>
<li><a href="#method-i-skip_password_field_on_login-3F">skip_password_field_on_login?</a></li>
<li><a href="#method-i-skip_status_checks-3F">skip_status_checks?</a></li>
<li><a href="#method-i-sms_auth_message">sms_auth_message</a></li>
<li><a href="#method-i-sms_available-3F">sms_available?</a></li>
<li><a href="#method-i-sms_code">sms_code</a></li>
<li><a href="#method-i-sms_code_issued_at">sms_code_issued_at</a></li>
<li><a href="#method-i-sms_code_match-3F">sms_code_match?</a></li>
<li><a href="#method-i-sms_codes_primary-3F">sms_codes_primary?</a></li>
<li><a href="#method-i-sms_confirm">sms_confirm</a></li>
<li><a href="#method-i-sms_confirm_failure">sms_confirm_failure</a></li>
<li><a href="#method-i-sms_confirm_message">sms_confirm_message</a></li>
<li><a href="#method-i-sms_confirmation_match-3F">sms_confirmation_match?</a></li>
<li><a href="#method-i-sms_current_auth-3F">sms_current_auth?</a></li>
<li><a href="#method-i-sms_disable">sms_disable</a></li>
<li><a href="#method-i-sms_ds">sms_ds</a></li>
<li><a href="#method-i-sms_failures">sms_failures</a></li>
<li><a href="#method-i-sms_locked_out-3F">sms_locked_out?</a></li>
<li><a href="#method-i-sms_needs_confirmation-3F">sms_needs_confirmation?</a></li>
<li><a href="#method-i-sms_new_auth_code">sms_new_auth_code</a></li>
<li><a href="#method-i-sms_new_confirm_code">sms_new_confirm_code</a></li>
<li><a href="#method-i-sms_normalize_phone">sms_normalize_phone</a></li>
<li><a href="#method-i-sms_phone">sms_phone</a></li>
<li><a href="#method-i-sms_record_failure">sms_record_failure</a></li>
<li><a href="#method-i-sms_remove_failures">sms_remove_failures</a></li>
<li><a href="#method-i-sms_send">sms_send</a></li>
<li><a href="#method-i-sms_send_auth_code">sms_send_auth_code</a></li>
<li><a href="#method-i-sms_send_confirm_code">sms_send_confirm_code</a></li>
<li><a href="#method-i-sms_set_code">sms_set_code</a></li>
<li><a href="#method-i-sms_setup">sms_setup</a></li>
<li><a href="#method-i-sms_setup-3F">sms_setup?</a></li>
<li><a href="#method-i-sms_valid_phone-3F">sms_valid_phone?</a></li>
<li><a href="#method-i-split_token">split_token</a></li>
<li><a href="#method-i-template_path">template_path</a></li>
<li><a href="#method-i-throw_basic_auth_error">throw_basic_auth_error</a></li>
<li><a href="#method-i-throw_error">throw_error</a></li>
<li><a href="#method-i-throw_error_status">throw_error_status</a></li>
<li><a href="#method-i-timing_safe_eql-3F">timing_safe_eql?</a></li>
<li><a href="#method-i-token_link">token_link</a></li>
<li><a href="#method-i-transaction">transaction</a></li>
<li><a href="#method-i-two_factor_auth_fallback_redirect">two_factor_auth_fallback_redirect</a></li>
<li><a href="#method-i-two_factor_auth_required_redirect">two_factor_auth_required_redirect</a></li>
<li><a href="#method-i-two_factor_authenticate">two_factor_authenticate</a></li>
<li><a href="#method-i-two_factor_authenticated-3F">two_factor_authenticated?</a></li>
<li><a href="#method-i-two_factor_authentication_setup-3F">two_factor_authentication_setup?</a></li>
<li><a href="#method-i-two_factor_modifications_require_password-3F">two_factor_modifications_require_password?</a></li>
<li><a href="#method-i-two_factor_need_setup_redirect">two_factor_need_setup_redirect</a></li>
<li><a href="#method-i-two_factor_password_match-3F">two_factor_password_match?</a></li>
<li><a href="#method-i-two_factor_remove">two_factor_remove</a></li>
<li><a href="#method-i-two_factor_remove_auth_failures">two_factor_remove_auth_failures</a></li>
<li><a href="#method-i-two_factor_remove_session">two_factor_remove_session</a></li>
<li><a href="#method-i-two_factor_update_session">two_factor_update_session</a></li>
<li><a href="#method-i-unique_constraint_violation_class">unique_constraint_violation_class</a></li>
<li><a href="#method-i-unlock_account">unlock_account</a></li>
<li><a href="#method-i-unlock_account_email_body">unlock_account_email_body</a></li>
<li><a href="#method-i-unlock_account_email_link">unlock_account_email_link</a></li>
<li><a href="#method-i-unlock_account_email_recently_sent-3F">unlock_account_email_recently_sent?</a></li>
<li><a href="#method-i-update_account">update_account</a></li>
<li><a href="#method-i-update_activity">update_activity</a></li>
<li><a href="#method-i-update_hash_ds">update_hash_ds</a></li>
<li><a href="#method-i-update_last_activity">update_last_activity</a></li>
<li><a href="#method-i-update_last_login">update_last_login</a></li>
<li><a href="#method-i-update_login">update_login</a></li>
<li><a href="#method-i-update_password_changed_at">update_password_changed_at</a></li>
<li><a href="#method-i-update_password_hash-3F">update_password_hash?</a></li>
<li><a href="#method-i-update_session">update_session</a></li>
<li><a href="#method-i-update_single_session_key">update_single_session_key</a></li>
<li><a href="#method-i-update_sms">update_sms</a></li>
<li><a href="#method-i-use_database_authentication_functions-3F">use_database_authentication_functions?</a></li>
<li><a href="#method-i-use_date_arithmetic-3F">use_date_arithmetic?</a></li>
<li><a href="#method-i-use_jwt-3F">use_jwt?</a></li>
<li><a href="#method-i-use_multi_phase_login-3F">use_multi_phase_login?</a></li>
<li><a href="#method-i-use_request_specific_csrf_tokens-3F">use_request_specific_csrf_tokens?</a></li>
<li><a href="#method-i-uses_two_factor_authentication-3F">uses_two_factor_authentication?</a></li>
<li><a href="#method-i-valid_jwt-3F">valid_jwt?</a></li>
<li><a href="#method-i-verified_account-3F">verified_account?</a></li>
<li><a href="#method-i-verify_account">verify_account</a></li>
<li><a href="#method-i-verify_account_check_already_logged_in">verify_account_check_already_logged_in</a></li>
<li><a href="#method-i-verify_account_ds">verify_account_ds</a></li>
<li><a href="#method-i-verify_account_email_body">verify_account_email_body</a></li>
<li><a href="#method-i-verify_account_email_link">verify_account_email_link</a></li>
<li><a href="#method-i-verify_account_email_recently_sent-3F">verify_account_email_recently_sent?</a></li>
<li><a href="#method-i-verify_account_email_resend">verify_account_email_resend</a></li>
<li><a href="#method-i-verify_account_key_insert_hash">verify_account_key_insert_hash</a></li>
<li><a href="#method-i-verify_account_resend_link">verify_account_resend_link</a></li>
<li><a href="#method-i-verify_login_change">verify_login_change</a></li>
<li><a href="#method-i-verify_login_change_ds">verify_login_change_ds</a></li>
<li><a href="#method-i-verify_login_change_email_body">verify_login_change_email_body</a></li>
<li><a href="#method-i-verify_login_change_email_link">verify_login_change_email_link</a></li>
<li><a href="#method-i-verify_login_change_key_insert_hash">verify_login_change_key_insert_hash</a></li>
<li><a href="#method-i-verify_login_change_old_login">verify_login_change_old_login</a></li>
<li><a href="#method-i-view">view</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='class-list'>
<h2>Classes and Modules</h2>
<ol>
<li><a href="Rodauth/ClassMethods.html">Rodauth::ClassMethods</a></li>
<li><a href="Rodauth/InstanceMethods.html">Rodauth::InstanceMethods</a></li>
<li><a href="Rodauth/ROTP.html">Rodauth::ROTP</a></li>
<li><a href="Rodauth/RequestMethods.html">Rodauth::RequestMethods</a></li>
<li><a href="Rodauth/Auth.html">Rodauth::Auth</a></li>
<li><a href="Rodauth/Configuration.html">Rodauth::Configuration</a></li>
<li><a href="Rodauth/Feature.html">Rodauth::Feature</a></li>
<li><a href="Rodauth/FeatureConfiguration.html">Rodauth::FeatureConfiguration</a></li>
</ol>
</div>
<div id='section'>
<div id='constants-list'>
<h2>Constants</h2>
<div class='name-list'>
<table summary='Constants'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>FEATURES</td>
<td>=</td>
<td class='context-item-value'>{}</td>
<td>&nbsp;</td>
<td class='context-item-desc'></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>MAJOR</td>
<td>=</td>
<td class='context-item-value'>1</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The major version of <a href="Rodauth.html">Rodauth</a>, updated only for
major changes that are likely to require modification to apps using <a
href="Rodauth.html">Rodauth</a>.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>MINOR</td>
<td>=</td>
<td class='context-item-value'>19</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The minor version of <a href="Rodauth.html">Rodauth</a>, updated for new
feature releases of <a href="Rodauth.html">Rodauth</a>.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>TINY</td>
<td>=</td>
<td class='context-item-value'>0</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The patch version of <a href="Rodauth.html">Rodauth</a>, updated only for
bug fixes from the last feature release.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>VERSION</td>
<td>=</td>
<td class='context-item-value'>"#{MAJOR}.#{MINOR}.#{TINY}".freeze</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The full version of <a href="Rodauth.html">Rodauth</a> as a string</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>VERSION_NUMBER</td>
<td>=</td>
<td class='context-item-value'>MAJOR*10000 + MINOR*100 + TINY</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The full version of <a href="Rodauth.html">Rodauth</a> as a number (1.17.0
=&gt; 11700)</p>
</td>
</tr>
</table>
</div>
</div>
<div id='aliases-list'>
<h2>Public Instance Aliases</h2>
<div class='name-list'>
<table summary='Public Instance Aliases'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>account_session_value</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-account_id">account_id</a></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>ignore_uniqueness_violation</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-raises_uniqueness_violation-3F">raises_uniqueness_violation?</a></td>
<td class='context-item-desc'>
<p>If you just want to ignore uniqueness violations, this alias makes more
sense.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>logged_in?</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-session_value">session_value</a></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>raised_uniqueness_violation</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-raises_uniqueness_violation-3F">raises_uniqueness_violation?</a></td>
<td class='context-item-desc'>
<p>If you would like to operate/reraise the exception, this alias makes more
sense.</p>
</td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-configure'>
<a name='method-c-configure'></a>
<div class='synopsis'>
<span class='name'>configure</span>
<span class='arguments'>(app, opts={}, &block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-configure-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-configure-source'><span class="ruby-comment"># File lib/rodauth.rb, line 32</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">configure</span>(<span class="ruby-identifier">app</span>, <span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>] = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:json</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>])&#x000A;  <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_csrf</span>] = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:csrf</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_route_csrf</span>])&#x000A;  <span class="ruby-identifier">auth_class</span> = (<span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauths</span>] <span class="ruby-operator">||=</span> {})[<span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>]] <span class="ruby-operator">||=</span> <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Auth</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span>&#x000A;    <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span> = <span class="ruby-identifier">app</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">app</span>&#x000A;    <span class="ruby-identifier">auth_class</span> = <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauths</span>][<span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>]] = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">auth_class</span>)&#x000A;    <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span> = <span class="ruby-identifier">app</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">configure</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-create_database_authentication_functions'>
<a name='method-c-create_database_authentication_functions'></a>
<div class='synopsis'>
<span class='name'>create_database_authentication_functions</span>
<span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-create_database_authentication_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-create_database_authentication_functions-source'><span class="ruby-comment"># File lib/rodauth/migrations.rb, line 3</span>&#x000A;  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">create_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})&#x000A;    <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:table_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:account_password_hashes</span>&#x000A;    <span class="ruby-identifier">get_salt_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:get_salt_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_get_salt</span>&#x000A;    <span class="ruby-identifier">valid_hash_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:valid_hash_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_valid_password_hash</span> &#x000A;&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:postgres</span>&#x000A;      <span class="ruby-identifier">search_path</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:search_path</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&#39;public, pg_temp&#39;</span>&#x000A;&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>&#x000A;<span class="ruby-value">CREATE OR REPLACE FUNCTION #{get_salt_name}(acct_id int8) RETURNS text AS $$&#x000A;DECLARE salt text;&#x000A;BEGIN&#x000A;SELECT substr(password_hash, 0, 30) INTO salt &#x000A;FROM #{table_name}&#x000A;WHERE acct_id = id;&#x000A;RETURN salt;&#x000A;END;&#x000A;$$ LANGUAGE plpgsql&#x000A;SECURITY DEFINER&#x000A;SET search_path = #{search_path};&#x000A;</span><span class="ruby-identifier">END</span>&#x000A;&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>&#x000A;<span class="ruby-value">CREATE OR REPLACE FUNCTION #{valid_hash_name}(acct_id int8, hash text) RETURNS boolean AS $$&#x000A;DECLARE valid boolean;&#x000A;BEGIN&#x000A;SELECT password_hash = hash INTO valid &#x000A;FROM #{table_name}&#x000A;WHERE acct_id = id;&#x000A;RETURN valid;&#x000A;END;&#x000A;$$ LANGUAGE plpgsql&#x000A;SECURITY DEFINER&#x000A;SET search_path = #{search_path};&#x000A;</span><span class="ruby-identifier">END</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:mysql</span>&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>&#x000A;<span class="ruby-value">CREATE FUNCTION #{get_salt_name}(acct_id int8) RETURNS varchar(255)&#x000A;SQL SECURITY DEFINER&#x000A;READS SQL DATA&#x000A;BEGIN&#x000A;RETURN (SELECT substr(password_hash, 1, 30)&#x000A;FROM #{table_name}&#x000A;WHERE acct_id = id);&#x000A;END;&#x000A;</span><span class="ruby-identifier">END</span>&#x000A;&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>&#x000A;<span class="ruby-value">CREATE FUNCTION #{valid_hash_name}(acct_id int8, hash varchar(255)) RETURNS tinyint(1)&#x000A;SQL SECURITY DEFINER&#x000A;READS SQL DATA&#x000A;BEGIN&#x000A;DECLARE valid tinyint(1);&#x000A;DECLARE csr CURSOR FOR &#x000A;SELECT password_hash = hash&#x000A;FROM #{table_name}&#x000A;WHERE acct_id = id;&#x000A;OPEN csr;&#x000A;FETCH csr INTO valid;&#x000A;CLOSE csr;&#x000A;RETURN valid;&#x000A;END;&#x000A;</span><span class="ruby-identifier">END</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:mssql</span>&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>&#x000A;<span class="ruby-value">CREATE FUNCTION #{get_salt_name}(@account_id bigint) RETURNS nvarchar(255)&#x000A;WITH EXECUTE AS OWNER&#x000A;AS&#x000A;BEGIN&#x000A;DECLARE @salt nvarchar(255);&#x000A;SELECT @salt = substring(password_hash, 0, 30)&#x000A;FROM #{table_name}&#x000A;WHERE id = @account_id;&#x000A;RETURN @salt;&#x000A;END;&#x000A;</span><span class="ruby-identifier">END</span>&#x000A;&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>&#x000A;<span class="ruby-value">CREATE FUNCTION #{valid_hash_name}(@account_id bigint, @hash nvarchar(255)) RETURNS bit&#x000A;WITH EXECUTE AS OWNER&#x000A;AS&#x000A;BEGIN&#x000A;DECLARE @valid bit;&#x000A;DECLARE @ph nvarchar(255);&#x000A;SELECT @ph = password_hash&#x000A;FROM #{table_name}&#x000A;WHERE id = @account_id;&#x000A;IF(@hash = @ph)&#x000A;  SET @valid = 1;&#x000A;ELSE&#x000A;  SET @valid = 0&#x000A;RETURN @valid;&#x000A;END;&#x000A;</span><span class="ruby-identifier">END</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-create_database_previous_password_check_functions'>
<a name='method-c-create_database_previous_password_check_functions'></a>
<div class='synopsis'>
<span class='name'>create_database_previous_password_check_functions</span>
<span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-create_database_previous_password_check_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-create_database_previous_password_check_functions-source'><span class="ruby-comment"># File lib/rodauth/migrations.rb, line 115</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">create_database_previous_password_check_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">create_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, {<span class="ruby-value">:table_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:account_previous_password_hashes</span>, <span class="ruby-value">:get_salt_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_get_previous_salt</span>, <span class="ruby-value">:valid_hash_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_previous_password_hash_match</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-drop_database_authentication_functions'>
<a name='method-c-drop_database_authentication_functions'></a>
<div class='synopsis'>
<span class='name'>drop_database_authentication_functions</span>
<span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-drop_database_authentication_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-drop_database_authentication_functions-source'><span class="ruby-comment"># File lib/rodauth/migrations.rb, line 101</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">drop_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">get_salt_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:get_salt_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_get_salt</span>&#x000A;  <span class="ruby-identifier">valid_hash_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:valid_hash_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_valid_password_hash</span> &#x000A;&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:postgres</span>&#x000A;    <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{get_salt_name}(int8)&quot;</span>&#x000A;    <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{valid_hash_name}(int8, text)&quot;</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:mysql</span>, <span class="ruby-value">:mssql</span>&#x000A;    <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{get_salt_name}&quot;</span>&#x000A;    <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{valid_hash_name}&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-drop_database_previous_password_check_functions'>
<a name='method-c-drop_database_previous_password_check_functions'></a>
<div class='synopsis'>
<span class='name'>drop_database_previous_password_check_functions</span>
<span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-drop_database_previous_password_check_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-drop_database_previous_password_check_functions-source'><span class="ruby-comment"># File lib/rodauth/migrations.rb, line 119</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">drop_database_previous_password_check_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">drop_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, {<span class="ruby-value">:get_salt_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_get_previous_salt</span>, <span class="ruby-value">:valid_hash_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_previous_password_hash_match</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-load_dependencies'>
<a name='method-c-load_dependencies'></a>
<div class='synopsis'>
<span class='name'>load_dependencies</span>
<span class='arguments'>(app, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-load_dependencies-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-load_dependencies-source'><span class="ruby-comment"># File lib/rodauth.rb, line 5</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">load_dependencies</span>(<span class="ruby-identifier">app</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">json_opt</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:json</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>])&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_opt</span>&#x000A;    <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:json</span>&#x000A;    <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:json_parser</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">json_opt</span> <span class="ruby-operator">==</span> <span class="ruby-value">:only</span>&#x000A;    <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;tilt/string&#39;</span>&#x000A;    <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:render</span>&#x000A;&#x000A;    <span class="ruby-keyword">case</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:csrf</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_route_csrf</span>])&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span>&#x000A;      <span class="ruby-comment"># nothing</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-value">:route_csrf</span>&#x000A;      <span class="ruby-comment"># :nocov:</span>&#x000A;      <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:route_csrf</span>&#x000A;      <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:csrf</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:flash</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:flash</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:h</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span>
<span class='arguments'>(scope)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 105</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">scope</span>)&#x000A;  <span class="ruby-ivar">@scope</span> = <span class="ruby-identifier">scope</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-version'>
<a name='method-c-version'></a>
<div class='synopsis'>
<span class='name'>version</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-version-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-version-source'><span class="ruby-comment"># File lib/rodauth/version.rb, line 20</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">version</span>&#x000A;  <span class="ruby-constant">VERSION</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-_account_from_email_auth_key'>
<a name='method-i-_account_from_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_email_auth_key</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_email_auth_key-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 248</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_email_auth_key</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">account_open_status_value</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">get_email_auth_key</span>(<span class="ruby-identifier">id</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_login'>
<a name='method-i-_account_from_login'></a>
<div class='synopsis'>
<span class='name'>_account_from_login</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_login-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 427</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_login</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">db</span>[<span class="ruby-identifier">accounts_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">account_select</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_select</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span>[<span class="ruby-identifier">account_unverified_status_value</span>, <span class="ruby-identifier">account_open_status_value</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_reset_password_key'>
<a name='method-i-_account_from_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_reset_password_key</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_reset_password_key-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 261</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_reset_password_key</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">account_open_status_value</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">get_password_reset_key</span>(<span class="ruby-identifier">id</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_session'>
<a name='method-i-_account_from_session'></a>
<div class='synopsis'>
<span class='name'>_account_from_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_session-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 434</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_session</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_ds</span>(<span class="ruby-identifier">session_value</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_session_status_filter</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_unlock_key'>
<a name='method-i-_account_from_unlock_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_unlock_key</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_unlock_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_unlock_key-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 301</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_unlock_key</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">account_lockouts_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_key_column</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_verify_account_key'>
<a name='method-i-_account_from_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_verify_account_key</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_verify_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 308</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_verify_account_key</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">account_unverified_status_value</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">get_verify_account_key</span>(<span class="ruby-identifier">id</span>)}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_verify_login_change_key'>
<a name='method-i-_account_from_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_verify_login_change_key</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_verify_login_change_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 203</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_verify_login_change_key</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-ivar">@verify_login_change_new_login</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">get_verify_login_change_login_and_key</span>(<span class="ruby-identifier">id</span>)&#x000A;    <span class="ruby-identifier">key</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_email_auth_request'>
<a name='method-i-_email_auth_request'></a>
<div class='synopsis'>
<span class='name'>_email_auth_request</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_email_auth_request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_email_auth_request-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 186</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_email_auth_request</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">email_auth_email_recently_sent?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">email_auth_email_recently_sent_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">email_auth_email_recently_sent_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">generate_email_auth_key_value</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">before_email_auth_request</span>&#x000A;    <span class="ruby-identifier">create_email_auth_key</span>&#x000A;    <span class="ruby-identifier">send_email_auth_email</span>&#x000A;    <span class="ruby-identifier">after_email_auth_request</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">set_notice_flash</span> <span class="ruby-identifier">email_auth_email_sent_notice_flash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_json_response_body'>
<a name='method-i-_json_response_body'></a>
<div class='synopsis'>
<span class='name'>_json_response_body</span>
<span class='arguments'>(hash)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_json_response_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_json_response_body-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 207</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_json_response_body</span>(<span class="ruby-identifier">hash</span>)&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:convert_to_json</span>, <span class="ruby-identifier">hash</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_login'>
<a name='method-i-_login'></a>
<div class='synopsis'>
<span class='name'>_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_login-source'><span class="ruby-comment"># File lib/rodauth/features/login.rb, line 85</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_login</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">before_login</span>&#x000A;    <span class="ruby-identifier">update_session</span>&#x000A;    <span class="ruby-identifier">after_login</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">set_notice_flash</span> <span class="ruby-identifier">login_notice_flash</span>&#x000A;  <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">login_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_new_account'>
<a name='method-i-_new_account'></a>
<div class='synopsis'>
<span class='name'>_new_account</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_new_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_new_account-source'><span class="ruby-comment"># File lib/rodauth/features/create_account.rb, line 123</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_new_account</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">acc</span> = {<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>}&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>&#x000A;    <span class="ruby-identifier">acc</span>[<span class="ruby-identifier">account_status_column</span>] = <span class="ruby-identifier">account_initial_status_value</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">acc</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp'>
<a name='method-i-_otp'></a>
<div class='synopsis'>
<span class='name'>_otp</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 339</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp</span>&#x000A;  <span class="ruby-identifier">otp_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">otp_key</span>, <span class="ruby-value">:issuer</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_issuer</span>, <span class="ruby-value">:digits</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_digits</span>, <span class="ruby-value">:interval</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_interval</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_add_key'>
<a name='method-i-_otp_add_key'></a>
<div class='synopsis'>
<span class='name'>_otp_add_key</span>
<span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_add_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_add_key-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 329</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_add_key</span>(<span class="ruby-identifier">secret</span>)&#x000A;  <span class="ruby-comment"># Uniqueness errors can&#39;t be handled here, as we can&#39;t be sure the secret provided</span>&#x000A;  <span class="ruby-comment"># is the same as the current secret.</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">otp_keys_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">otp_keys_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">secret</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_key'>
<a name='method-i-_otp_key'></a>
<div class='synopsis'>
<span class='name'>_otp_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_key-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 335</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_key</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">otp_keys_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_tmp_key'>
<a name='method-i-_otp_tmp_key'></a>
<div class='synopsis'>
<span class='name'>_otp_tmp_key</span>
<span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_tmp_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_tmp_key-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 325</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_tmp_key</span>(<span class="ruby-identifier">secret</span>)&#x000A;  <span class="ruby-ivar">@otp_key</span> = <span class="ruby-identifier">secret</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_recovery_codes'>
<a name='method-i-_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>_recovery_codes</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_recovery_codes-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 232</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_recovery_codes</span>&#x000A;  <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">select_map</span>(<span class="ruby-identifier">recovery_codes_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_sms'>
<a name='method-i-_sms'></a>
<div class='synopsis'>
<span class='name'>_sms</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_sms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_sms-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 496</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_sms</span>&#x000A;  <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">first</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_two_factor_auth_required_redirect'>
<a name='method-i-_two_factor_auth_required_redirect'></a>
<div class='synopsis'>
<span class='name'>_two_factor_auth_required_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_two_factor_auth_required_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_two_factor_auth_required_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 144</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_two_factor_auth_required_redirect</span>&#x000A;  <span class="ruby-identifier">two_factor_auth_required_redirect</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">two_factor_auth_fallback_redirect</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_update_login'>
<a name='method-i-_update_login'></a>
<div class='synopsis'>
<span class='name'>_update_login</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_update_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_update_login-source'><span class="ruby-comment"># File lib/rodauth/features/change_login.rb, line 79</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_update_login</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">updated</span> = <span class="ruby-keyword">nil</span>&#x000A;  <span class="ruby-identifier">raised</span> = <span class="ruby-identifier">raises_uniqueness_violation?</span>{<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">update_account</span>({<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>}, <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>)) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>}&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">raised</span>&#x000A;    <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-string">&#39;already an account with this login&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">updated</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">raised</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_view'>
<a name='method-i-_view'></a>
<div class='synopsis'>
<span class='name'>_view</span>
<span class='arguments'>(meth, page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_view-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_view-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 555</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_view</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">_view_opts</span>(<span class="ruby-identifier">page</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_view_opts'>
<a name='method-i-_view_opts'></a>
<div class='synopsis'>
<span class='name'>_view_opts</span>
<span class='arguments'>(page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_view_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_view_opts-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 537</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_view_opts</span>(<span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-identifier">auth_template_path</span> = <span class="ruby-identifier">template_path</span>(<span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">template_opts</span>.<span class="ruby-identifier">dup</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>].<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> {}&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>][<span class="ruby-value">:rodauth</span>] = <span class="ruby-keyword">self</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache</span>] = <span class="ruby-identifier">cache_templates</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache_key</span>] = <span class="ruby-value">:&quot;rodauth_#{page}&quot;</span>&#x000A;&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">find_template</span>(<span class="ruby-identifier">parse_template_opts</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">opts</span>))&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">template_path</span>(<span class="ruby-identifier">opts</span>))&#x000A;      <span class="ruby-identifier">opts</span>[<span class="ruby-value">:path</span>] = <span class="ruby-identifier">auth_template_path</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">opts</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_activity_ds'>
<a name='method-i-account_activity_ds'></a>
<div class='synopsis'>
<span class='name'>account_activity_ds</span>
<span class='arguments'>(account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_activity_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_activity_ds-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 103</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">account_activity_table</span>].&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_activity_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_ds'>
<a name='method-i-account_ds'></a>
<div class='synopsis'>
<span class='name'>account_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_ds-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 448</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;invalid account id passed to account_ds&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">db</span>[<span class="ruby-identifier">accounts_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">account_select</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_select</span>&#x000A;  <span class="ruby-identifier">ds</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_expired-3F'>
<a name='method-i-account_expired-3F'></a>
<div class='synopsis'>
<span class='name'>account_expired?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_expired-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_expired-3F-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 53</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_expired?</span>&#x000A;  <span class="ruby-identifier">columns</span> = [<span class="ruby-identifier">account_activity_last_activity_column</span>, <span class="ruby-identifier">account_activity_last_login_column</span>, <span class="ruby-identifier">account_activity_expired_column</span>]&#x000A;  <span class="ruby-identifier">last_activity</span>, <span class="ruby-identifier">last_login</span>, <span class="ruby-identifier">expired</span> = <span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">columns</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">expired</span>&#x000A;  <span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">expire_account_on_last_activity?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">last_activity</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">last_login</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">timestamp</span>&#x000A;  <span class="ruby-identifier">timestamp</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">expire_account_after</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_expired_at'>
<a name='method-i-account_expired_at'></a>
<div class='synopsis'>
<span class='name'>account_expired_at</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_expired_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_expired_at-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 34</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_expired_at</span>&#x000A;  <span class="ruby-identifier">get_activity_timestamp</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_activity_expired_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_email_auth_key'>
<a name='method-i-account_from_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>account_from_email_auth_key</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_email_auth_key-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 130</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_email_auth_key</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_email_auth_key</span>(<span class="ruby-identifier">key</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_key'>
<a name='method-i-account_from_key'></a>
<div class='synopsis'>
<span class='name'>account_from_key</span>
<span class='arguments'>(token, status_id=nil)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_key-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 55</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">status_id</span>=<span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-identifier">id</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">split_token</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span>&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">actual</span> = <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">id</span>)&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">actual</span>)&#x000A;&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_ds</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">status_id</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">status_id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">skip_status_checks?</span>&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_login'>
<a name='method-i-account_from_login'></a>
<div class='synopsis'>
<span class='name'>account_from_login</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_login-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 156</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_login</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_login</span>(<span class="ruby-identifier">login</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_reset_password_key'>
<a name='method-i-account_from_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>account_from_reset_password_key</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_reset_password_key-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 44</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_reset_password_key</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span> = <span class="ruby-keyword">super</span>&#x000A;    <span class="ruby-identifier">check_password_change_allowed</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">a</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_session'>
<a name='method-i-account_from_session'></a>
<div class='synopsis'>
<span class='name'>account_from_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_session-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 235</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_session</span>&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_session</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_unlock_key'>
<a name='method-i-account_from_unlock_key'></a>
<div class='synopsis'>
<span class='name'>account_from_unlock_key</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_unlock_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_unlock_key-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 210</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_unlock_key</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_unlock_key</span>(<span class="ruby-identifier">key</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_verify_account_key'>
<a name='method-i-account_from_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>account_from_verify_account_key</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_verify_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 189</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_verify_account_key</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_verify_account_key</span>(<span class="ruby-identifier">key</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_verify_login_change_key'>
<a name='method-i-account_from_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>account_from_verify_login_change_key</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_verify_login_change_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 113</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_verify_login_change_key</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_verify_login_change_key</span>(<span class="ruby-identifier">key</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_id'>
<a name='method-i-account_id'></a>
<div class='synopsis'>
<span class='name'>account_id</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_id-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 146</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_id</span>&#x000A;  <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_id_column</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_in_unverified_grace_period-3F'>
<a name='method-i-account_in_unverified_grace_period-3F'></a>
<div class='synopsis'>
<span class='name'>account_in_unverified_grace_period?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_in_unverified_grace_period-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_in_unverified_grace_period-3F-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb, line 65</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_in_unverified_grace_period?</span>&#x000A;  <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_status_column</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">account_unverified_status_value</span> <span class="ruby-operator">&amp;&amp;</span>&#x000A;    <span class="ruby-identifier">verify_account_grace_period</span> <span class="ruby-operator">&amp;&amp;</span>&#x000A;    <span class="ruby-operator">!</span><span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-identifier">verification_requested_at_column</span>, <span class="ruby-value">:seconds</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">verify_account_grace_period</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>).<span class="ruby-identifier">empty?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_initial_status_value'>
<a name='method-i-account_initial_status_value'></a>
<div class='synopsis'>
<span class='name'>account_initial_status_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_initial_status_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_initial_status_value-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 231</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_initial_status_value</span>&#x000A;  <span class="ruby-identifier">account_open_status_value</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_lockouts_ds'>
<a name='method-i-account_lockouts_ds'></a>
<div class='synopsis'>
<span class='name'>account_lockouts_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_lockouts_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_lockouts_ds-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 297</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_lockouts_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">account_lockouts_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_lockouts_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_login_failures_ds'>
<a name='method-i-account_login_failures_ds'></a>
<div class='synopsis'>
<span class='name'>account_login_failures_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_login_failures_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_login_failures_ds-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 293</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_login_failures_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">account_login_failures_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_login_failures_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_model'>
<a name='method-i-account_model'></a>
<div class='synopsis'>
<span class='name'>account_model</span>
<span class='arguments'>(model)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_model-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_model-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 94</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_model</span>(<span class="ruby-identifier">model</span>)&#x000A;  <span class="ruby-identifier">warn</span> <span class="ruby-string">&quot;account_model is deprecated, use db and accounts_table settings&quot;</span>&#x000A;  <span class="ruby-identifier">db</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">db</span>&#x000A;  <span class="ruby-identifier">accounts_table</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">table_name</span>&#x000A;  <span class="ruby-identifier">account_select</span> <span class="ruby-identifier">model</span>.<span class="ruby-identifier">dataset</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:select</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_password_hash_column'>
<a name='method-i-account_password_hash_column'></a>
<div class='synopsis'>
<span class='name'>account_password_hash_column</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>If the <a
href="Rodauth.html#method-i-account_password_hash_column">#account_password_hash_column</a>
is set, the password hash is verified in ruby, it will not use a database
function to do so, it will check the password hash using bcrypt.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_password_hash_column-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_password_hash_column-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 171</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_password_hash_column</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_session_status_filter'>
<a name='method-i-account_session_status_filter'></a>
<div class='synopsis'>
<span class='name'>account_session_status_filter</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_session_status_filter-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_session_status_filter-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 440</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_session_status_filter</span>&#x000A;  {<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_open_status_value</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-active_remember_key_ds'>
<a name='method-i-active_remember_key_ds'></a>
<div class='synopsis'>
<span class='name'>active_remember_key_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-active_remember_key_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-active_remember_key_ds-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 197</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">active_remember_key_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">remember_deadline_column</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_previous_password_hash'>
<a name='method-i-add_previous_password_hash'></a>
<div class='synopsis'>
<span class='name'>add_previous_password_hash</span>
<span class='arguments'>(hash)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_previous_password_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_previous_password_hash-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb, line 24</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_previous_password_hash</span>(<span class="ruby-identifier">hash</span>) &#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">previous_password_ds</span>&#x000A;  <span class="ruby-identifier">keep_before</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">reverse</span>(<span class="ruby-identifier">previous_password_id_column</span>).&#x000A;    <span class="ruby-identifier">limit</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">previous_passwords_to_check</span>).&#x000A;    <span class="ruby-identifier">get</span>(<span class="ruby-identifier">previous_password_id_column</span>)&#x000A;&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">previous_password_id_column</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">keep_before</span>).&#x000A;    <span class="ruby-identifier">delete</span>&#x000A;&#x000A;  <span class="ruby-comment"># This should never raise uniqueness violations, as it uses a serial primary key</span>&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">previous_password_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">previous_password_hash_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">hash</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_recovery_code'>
<a name='method-i-add_recovery_code'></a>
<div class='synopsis'>
<span class='name'>add_recovery_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_recovery_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_recovery_code-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 213</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_recovery_code</span>&#x000A;  <span class="ruby-comment"># This should never raise uniqueness violations unless the recovery code is the same, and the odds of that</span>&#x000A;  <span class="ruby-comment"># are 1/256**32 assuming a good random number generator.  Still, attempt to handle that case by retrying</span>&#x000A;  <span class="ruby-comment"># on such a uniqueness violation.</span>&#x000A;  <span class="ruby-identifier">retry_on_uniqueness_violation</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">recovery_codes_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">recovery_codes_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">new_recovery_code</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_recovery_codes'>
<a name='method-i-add_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>add_recovery_codes</span>
<span class='arguments'>(number)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_recovery_codes-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 203</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_recovery_codes</span>(<span class="ruby-identifier">number</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">number</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">number</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>&#x000A;      <span class="ruby-identifier">add_recovery_code</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">remove_instance_variable</span>(<span class="ruby-value">:@recovery_codes</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_remember_key'>
<a name='method-i-add_remember_key'></a>
<div class='synopsis'>
<span class='name'>add_remember_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_remember_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_remember_key-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 143</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_remember_key</span>&#x000A;  <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">remember_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">remember_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">remember_key_value</span>}&#x000A;  <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">remember_deadline_column</span>, <span class="ruby-identifier">remember_deadline_interval</span>)&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">remember_key_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)}&#x000A;    <span class="ruby-comment"># If inserting into the remember key table causes a violation, we can pull the</span>&#x000A;    <span class="ruby-comment"># existing row from the table.  If there is no invalid row, we can then reraise.</span>&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@remember_key_value</span> = <span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_key_column</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_change_login'>
<a name='method-i-after_change_login'></a>
<div class='synopsis'>
<span class='name'>after_change_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_change_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_change_login-source'><span class="ruby-comment"># File lib/rodauth/features/verify_change_login.rb, line 12</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_change_login</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-identifier">update_account</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_unverified_status_value</span>)&#x000A;  <span class="ruby-identifier">setup_account_verification</span>&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">unverified_account_session_key</span>] = <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_change_password'>
<a name='method-i-after_change_password'></a>
<div class='synopsis'>
<span class='name'>after_change_password</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_change_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_change_password-source'><span class="ruby-comment"># File lib/rodauth/features/change_password_notify.rb, line 30</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_change_password</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-identifier">send_password_changed_email</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_close_account'>
<a name='method-i-after_close_account'></a>
<div class='synopsis'>
<span class='name'>after_close_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_close_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_close_account-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 93</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_close_account</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;  <span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>).<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_confirm_password'>
<a name='method-i-after_confirm_password'></a>
<div class='synopsis'>
<span class='name'>after_confirm_password</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_confirm_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_confirm_password-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 178</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_confirm_password</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-identifier">clear_remembered_session_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_create_account'>
<a name='method-i-after_create_account'></a>
<div class='synopsis'>
<span class='name'>after_create_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_create_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_create_account-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb, line 69</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_create_account</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_password_hash_column</span>&#x000A;    <span class="ruby-identifier">add_previous_password_hash</span>(<span class="ruby-identifier">password_hash</span>(<span class="ruby-identifier">param</span>(<span class="ruby-identifier">password_param</span>)))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_login'>
<a name='method-i-after_login'></a>
<div class='synopsis'>
<span class='name'>after_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_login-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 205</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_login</span>&#x000A;  <span class="ruby-comment"># Remove the email auth key after any login, even if</span>&#x000A;  <span class="ruby-comment"># it is a password login.  This is done to invalidate</span>&#x000A;  <span class="ruby-comment"># the email login when a user has a password and requests</span>&#x000A;  <span class="ruby-comment"># email authentication, but then remembers their password</span>&#x000A;  <span class="ruby-comment"># and doesn&#39;t need the link.  At that point, the link</span>&#x000A;  <span class="ruby-comment"># that allows login access to the account becomes a</span>&#x000A;  <span class="ruby-comment"># security liability, and it is best to remove it.</span>&#x000A;  <span class="ruby-identifier">remove_email_auth_key</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_login_entered_during_multi_phase_login'>
<a name='method-i-after_login_entered_during_multi_phase_login'></a>
<div class='synopsis'>
<span class='name'>after_login_entered_during_multi_phase_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_login_entered_during_multi_phase_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_login_entered_during_multi_phase_login-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 158</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_login_entered_during_multi_phase_login</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">force_email_auth?</span>&#x000A;    <span class="ruby-comment"># If the account does not have a password hash, just send the</span>&#x000A;    <span class="ruby-comment"># email link.</span>&#x000A;    <span class="ruby-identifier">_email_auth_request</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">email_auth_email_sent_redirect</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-comment"># If the account has a password hash, allow password login, but</span>&#x000A;    <span class="ruby-comment"># show form below to also login via email link.</span>&#x000A;    <span class="ruby-keyword">super</span>&#x000A;    <span class="ruby-ivar">@email_auth_request_form</span> = <span class="ruby-identifier">email_auth_request_form</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_login_failure'>
<a name='method-i-after_login_failure'></a>
<div class='synopsis'>
<span class='name'>after_login_failure</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_login_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_login_failure-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 251</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_login_failure</span>&#x000A;  <span class="ruby-identifier">invalid_login_attempted</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_logout'>
<a name='method-i-after_logout'></a>
<div class='synopsis'>
<span class='name'>after_logout</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_logout-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_logout-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 168</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_logout</span>&#x000A;  <span class="ruby-identifier">forget_login</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_reset_password'>
<a name='method-i-after_reset_password'></a>
<div class='synopsis'>
<span class='name'>after_reset_password</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_reset_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_reset_password-source'><span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb, line 26</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_reset_password</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;  <span class="ruby-ivar">@last_password_entry</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-allow_resending_verify_account_email-3F'>
<a name='method-i-allow_resending_verify_account_email-3F'></a>
<div class='synopsis'>
<span class='name'>allow_resending_verify_account_email?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-allow_resending_verify_account_email-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-allow_resending_verify_account_email-3F-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 155</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">allow_resending_verify_account_email?</span>&#x000A;  <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_status_column</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">account_unverified_status_value</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-already_logged_in'>
<a name='method-i-already_logged_in'></a>
<div class='synopsis'>
<span class='name'>already_logged_in</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-already_logged_in-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-already_logged_in-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 179</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">already_logged_in</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-auth_class_eval'>
<a name='method-i-auth_class_eval'></a>
<div class='synopsis'>
<span class='name'>auth_class_eval</span>
<span class='arguments'>(&block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-auth_class_eval-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-auth_class_eval-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 90</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">auth_class_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">auth</span>.<span class="ruby-identifier">class_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-authenticated-3F'>
<a name='method-i-authenticated-3F'></a>
<div class='synopsis'>
<span class='name'>authenticated?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-authenticated-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-authenticated-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 223</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">authenticated?</span>&#x000A;  <span class="ruby-identifier">logged_in?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_change_login_route'>
<a name='method-i-before_change_login_route'></a>
<div class='synopsis'>
<span class='name'>before_change_login_route</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_change_login_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_change_login_route-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb, line 35</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_change_login_route</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">verified_account?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">unverified_change_login_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">unverified_change_login_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_change_password_route'>
<a name='method-i-before_change_password_route'></a>
<div class='synopsis'>
<span class='name'>before_change_password_route</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_change_password_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_change_password_route-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 89</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_change_password_route</span>&#x000A;  <span class="ruby-identifier">check_password_change_allowed</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_login_attempt'>
<a name='method-i-before_login_attempt'></a>
<div class='synopsis'>
<span class='name'>before_login_attempt</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_login_attempt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_login_attempt-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 239</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_login_attempt</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">locked_out?</span>&#x000A;    <span class="ruby-identifier">show_lockout_page</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_logout'>
<a name='method-i-before_logout'></a>
<div class='synopsis'>
<span class='name'>before_logout</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_logout-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_logout-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 71</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_logout</span>&#x000A;  <span class="ruby-identifier">reset_single_session_key</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_otp_authentication_route'>
<a name='method-i-before_otp_authentication_route'></a>
<div class='synopsis'>
<span class='name'>before_otp_authentication_route</span>
<span class='arguments'>(&block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_otp_authentication_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_otp_authentication_route-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 22</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_otp_authentication_route</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">warn</span> <span class="ruby-string">&quot;before_otp_authentication_route is deprecated, switch to before_otp_auth_route&quot;</span>&#x000A;  <span class="ruby-identifier">before_otp_auth_route</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_reset_password'>
<a name='method-i-before_reset_password'></a>
<div class='synopsis'>
<span class='name'>before_reset_password</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_reset_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_reset_password-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 73</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_reset_password</span>&#x000A;  <span class="ruby-identifier">check_account_expiration</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_reset_password_request'>
<a name='method-i-before_reset_password_request'></a>
<div class='synopsis'>
<span class='name'>before_reset_password_request</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_reset_password_request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_reset_password_request-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 78</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_reset_password_request</span>&#x000A;  <span class="ruby-identifier">check_account_expiration</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_rodauth'>
<a name='method-i-before_rodauth'></a>
<div class='synopsis'>
<span class='name'>before_rodauth</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_rodauth-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_rodauth-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 142</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_rodauth</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_request?</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">jwt_check_accept?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">accept</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ACCEPT&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">accept</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">json_accept_regexp</span>&#x000A;      <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">406</span>&#x000A;      <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_error_key</span>] = <span class="ruby-identifier">json_not_accepted_error_message</span>&#x000A;      <span class="ruby-identifier">response</span>[<span class="ruby-string">&#39;Content-Type&#39;</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">json_response_content_type</span>&#x000A;      <span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:convert_to_json</span>, <span class="ruby-identifier">json_response</span>))&#x000A;      <span class="ruby-identifier">request</span>.<span class="ruby-identifier">halt</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>&#x000A;      <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">405</span>&#x000A;      <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Allow&#39;</span>] = <span class="ruby-string">&#39;POST&#39;</span>&#x000A;      <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_error_key</span>] = <span class="ruby-identifier">json_non_post_error_message</span>&#x000A;      <span class="ruby-identifier">return_json_response</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">only_json?</span>&#x000A;    <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-identifier">json_response_error_status</span>&#x000A;    <span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">non_json_request_error_message</span>&#x000A;    <span class="ruby-identifier">request</span>.<span class="ruby-identifier">halt</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_unlock_account'>
<a name='method-i-before_unlock_account'></a>
<div class='synopsis'>
<span class='name'>before_unlock_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_unlock_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_unlock_account-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 83</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_unlock_account</span>&#x000A;  <span class="ruby-identifier">check_account_expiration</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_unlock_account_request'>
<a name='method-i-before_unlock_account_request'></a>
<div class='synopsis'>
<span class='name'>before_unlock_account_request</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_unlock_account_request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_unlock_account_request-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 88</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_unlock_account_request</span>&#x000A;  <span class="ruby-identifier">check_account_expiration</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_view_recovery_codes'>
<a name='method-i-before_view_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>before_view_recovery_codes</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_view_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_view_recovery_codes-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 167</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_view_recovery_codes</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_jwt?</span>&#x000A;    <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:codes</span>] = <span class="ruby-identifier">recovery_codes</span>&#x000A;    <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_success_key</span>] <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">include_success_messages?</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-button'>
<a name='method-i-button'></a>
<div class='synopsis'>
<span class='name'>button</span>
<span class='arguments'>(value, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-button-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-button-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 260</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">button</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">opts</span>={})&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">button_opts</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">opts</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-button_opts'>
<a name='method-i-button_opts'></a>
<div class='synopsis'>
<span class='name'>button_opts</span>
<span class='arguments'>(value, opts)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-button_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-button_opts-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 251</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">button_opts</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">template_opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>] = {<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">value</span>, <span class="ruby-value">:opts</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">opts</span>}&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:path</span>] = <span class="ruby-identifier">template_path</span>(<span class="ruby-string">&#39;button&#39;</span>)&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache</span>] = <span class="ruby-identifier">cache_templates</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache_key</span>] = <span class="ruby-value">:rodauth_button</span>&#x000A;  <span class="ruby-identifier">opts</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-can_add_recovery_codes-3F'>
<a name='method-i-can_add_recovery_codes-3F'></a>
<div class='synopsis'>
<span class='name'>can_add_recovery_codes?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-can_add_recovery_codes-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-can_add_recovery_codes-3F-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 199</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">can_add_recovery_codes?</span>&#x000A;  <span class="ruby-identifier">recovery_codes</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">recovery_codes_limit</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-catch_error'>
<a name='method-i-catch_error'></a>
<div class='synopsis'>
<span class='name'>catch_error</span>
<span class='arguments'>(&block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-catch_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-catch_error-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 358</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">catch_error</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">catch</span>(<span class="ruby-value">:rodauth_error</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_login'>
<a name='method-i-change_login'></a>
<div class='synopsis'>
<span class='name'>change_login</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_login-source'><span class="ruby-comment"># File lib/rodauth/features/change_login.rb, line 64</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_login</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">login_column</span>).<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">downcase</span>&#x000A;    <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-string">&#39;same as current login&#39;</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">update_login</span>(<span class="ruby-identifier">login</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_login_notice_flash'>
<a name='method-i-change_login_notice_flash'></a>
<div class='synopsis'>
<span class='name'>change_login_notice_flash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_login_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_login_notice_flash-source'><span class="ruby-comment"># File lib/rodauth/features/verify_change_login.rb, line 6</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_login_notice_flash</span>&#x000A;  <span class="ruby-node">&quot;#{super}. #{verify_account_email_sent_notice_flash}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_login_requires_password-3F'>
<a name='method-i-change_login_requires_password-3F'></a>
<div class='synopsis'>
<span class='name'>change_login_requires_password?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_login_requires_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_login_requires_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/change_login.rb, line 60</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_login_requires_password?</span>&#x000A;  <span class="ruby-identifier">modifications_require_password?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_password_requires_password-3F'>
<a name='method-i-change_password_requires_password-3F'></a>
<div class='synopsis'>
<span class='name'>change_password_requires_password?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_password_requires_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_password_requires_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/change_password.rb, line 65</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_password_requires_password?</span>&#x000A;  <span class="ruby-identifier">modifications_require_password?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_account_expiration'>
<a name='method-i-check_account_expiration'></a>
<div class='synopsis'>
<span class='name'>check_account_expiration</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_account_expiration-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_account_expiration-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 62</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_account_expiration</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_expired?</span>&#x000A;    <span class="ruby-identifier">set_expired</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_expired_at</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">account_expiration_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">account_expiration_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">update_last_login</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_already_logged_in'>
<a name='method-i-check_already_logged_in'></a>
<div class='synopsis'>
<span class='name'>check_already_logged_in</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_already_logged_in-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_already_logged_in-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 175</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_already_logged_in</span>&#x000A;  <span class="ruby-identifier">already_logged_in</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_password_change_allowed'>
<a name='method-i-check_password_change_allowed'></a>
<div class='synopsis'>
<span class='name'>check_password_change_allowed</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_password_change_allowed-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_password_change_allowed-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 29</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_password_change_allowed</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> = <span class="ruby-identifier">get_password_changed_at</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">allow_password_change_after</span>&#x000A;      <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">password_not_changeable_yet_error_flash</span>&#x000A;      <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">password_not_changeable_yet_redirect</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_session_expiration'>
<a name='method-i-check_session_expiration'></a>
<div class='synopsis'>
<span class='name'>check_session_expiration</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_session_expiration-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_session_expiration-source'><span class="ruby-comment"># File lib/rodauth/features/session_expiration.rb, line 14</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_session_expiration</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">session_last_activity_session_key</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">session_created_session_key</span>)&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_expiration_default</span>&#x000A;      <span class="ruby-identifier">expire_session</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;&#x000A;    <span class="ruby-keyword">return</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_last_activity_session_key</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">session_inactivity_timeout</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">time</span>&#x000A;    <span class="ruby-identifier">expire_session</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">session_last_activity_session_key</span>, <span class="ruby-identifier">time</span>)&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_created_session_key</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">max_session_lifetime</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">time</span>&#x000A;    <span class="ruby-identifier">expire_session</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_single_session'>
<a name='method-i-check_single_session'></a>
<div class='synopsis'>
<span class='name'>check_single_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_single_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_single_session-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 41</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_single_session</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">currently_active_session?</span>&#x000A;    <span class="ruby-identifier">no_longer_active_session</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_cached_otp'>
<a name='method-i-clear_cached_otp'></a>
<div class='synopsis'>
<span class='name'>clear_cached_otp</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_cached_otp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_cached_otp-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 308</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_cached_otp</span>&#x000A;  <span class="ruby-identifier">remove_instance_variable</span>(<span class="ruby-value">:@otp</span>) <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@otp</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_invalid_login_attempts'>
<a name='method-i-clear_invalid_login_attempts'></a>
<div class='synopsis'>
<span class='name'>clear_invalid_login_attempts</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_invalid_login_attempts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_invalid_login_attempts-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 160</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_invalid_login_attempts</span>&#x000A;  <span class="ruby-identifier">unlock_account</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_remembered_session_key'>
<a name='method-i-clear_remembered_session_key'></a>
<div class='synopsis'>
<span class='name'>clear_remembered_session_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_remembered_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_remembered_session_key-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 158</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_remembered_session_key</span>&#x000A;  <span class="ruby-identifier">session</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">remembered_session_key</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_session'>
<a name='method-i-clear_session'></a>
<div class='synopsis'>
<span class='name'>clear_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_session-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 183</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_session</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:clear_session</span>)&#x000A;    <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">clear_session</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">session</span>.<span class="ruby-identifier">clear</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-close_account'>
<a name='method-i-close_account'></a>
<div class='synopsis'>
<span class='name'>close_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-close_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-close_account-source'><span class="ruby-comment"># File lib/rodauth/features/close_account.rb, line 61</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">close_account</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>&#x000A;    <span class="ruby-identifier">update_account</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_closed_status_value</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_password_hash_column</span>&#x000A;    <span class="ruby-identifier">password_hash_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-close_account_requires_password-3F'>
<a name='method-i-close_account_requires_password-3F'></a>
<div class='synopsis'>
<span class='name'>close_account_requires_password?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-close_account_requires_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-close_account_requires_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/close_account.rb, line 57</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">close_account_requires_password?</span>&#x000A;  <span class="ruby-identifier">modifications_require_password?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-confirm_password'>
<a name='method-i-confirm_password'></a>
<div class='synopsis'>
<span class='name'>confirm_password</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-confirm_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-confirm_password-source'><span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb, line 44</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">confirm_password</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-confirm_password_redirect'>
<a name='method-i-confirm_password_redirect'></a>
<div class='synopsis'>
<span class='name'>confirm_password_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-confirm_password_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-confirm_password_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb, line 48</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">confirm_password_redirect</span>&#x000A;  <span class="ruby-identifier">session</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">confirm_password_redirect_session_key</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">default_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_session_key'>
<a name='method-i-convert_session_key'></a>
<div class='synopsis'>
<span class='name'>convert_session_key</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_session_key-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 337</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_session_key</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:sessions_convert_symbols</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_timestamp'>
<a name='method-i-convert_timestamp'></a>
<div class='synopsis'>
<span class='name'>convert_timestamp</span>
<span class='arguments'>(timestamp)</span>

</div>
<div class='description'>

<p>This is needed for jdbc/sqlite, which returns timestamp columns as strings</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_timestamp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_timestamp-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 460</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_timestamp</span>(<span class="ruby-identifier">timestamp</span>)&#x000A;  <span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">to_application_timestamp</span>(<span class="ruby-identifier">timestamp</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">timestamp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)&#x000A;  <span class="ruby-identifier">timestamp</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_autologin-3F'>
<a name='method-i-create_account_autologin-3F'></a>
<div class='synopsis'>
<span class='name'>create_account_autologin?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_autologin-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_autologin-3F-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 213</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_autologin?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_link'>
<a name='method-i-create_account_link'></a>
<div class='synopsis'>
<span class='name'>create_account_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_link-source'><span class="ruby-comment"># File lib/rodauth/features/create_account.rb, line 90</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_link</span>&#x000A;  <span class="ruby-node">&quot;&lt;p&gt;&lt;a href=\&quot;#{prefix}/#{create_account_route}\&quot;&gt;Create a New Account&lt;/a&gt;&lt;/p&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_notice_flash'>
<a name='method-i-create_account_notice_flash'></a>
<div class='synopsis'>
<span class='name'>create_account_notice_flash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_notice_flash-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 175</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_notice_flash</span>&#x000A;  <span class="ruby-identifier">verify_account_email_sent_notice_flash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_set_password-3F'>
<a name='method-i-create_account_set_password-3F'></a>
<div class='synopsis'>
<span class='name'>create_account_set_password?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_set_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_set_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 225</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_set_password?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">verify_account_set_password?</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email'>
<a name='method-i-create_email'></a>
<div class='synopsis'>
<span class='name'>create_email</span>
<span class='arguments'>(subject, body)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 26</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email</span>(<span class="ruby-identifier">subject</span>, <span class="ruby-identifier">body</span>)&#x000A;  <span class="ruby-identifier">create_email_to</span>(<span class="ruby-identifier">email_to</span>, <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email_auth_email'>
<a name='method-i-create_email_auth_email'></a>
<div class='synopsis'>
<span class='name'>create_email_auth_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email_auth_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email_auth_email-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 226</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email_auth_email</span>&#x000A;  <span class="ruby-identifier">create_email</span>(<span class="ruby-identifier">email_auth_email_subject</span>, <span class="ruby-identifier">email_auth_email_body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email_auth_key'>
<a name='method-i-create_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>create_email_auth_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email_auth_key-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 101</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email_auth_key</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">email_auth_key_value</span> = <span class="ruby-identifier">get_email_auth_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;      <span class="ruby-identifier">set_email_auth_email_last_sent</span>&#x000A;      <span class="ruby-ivar">@email_auth_key_value</span> = <span class="ruby-identifier">email_auth_key_value</span>&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">email_auth_key_insert_hash</span>)}&#x000A;      <span class="ruby-comment"># If inserting into the email auth table causes a violation, we can pull the</span>&#x000A;      <span class="ruby-comment"># existing email auth key from the table, or reraise.</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@email_auth_key_value</span> = <span class="ruby-identifier">get_email_auth_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email_to'>
<a name='method-i-create_email_to'></a>
<div class='synopsis'>
<span class='name'>create_email_to</span>
<span class='arguments'>(to, subject, body)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email_to-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email_to-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 30</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email_to</span>(<span class="ruby-identifier">to</span>, <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">body</span>)&#x000A;  <span class="ruby-identifier">m</span> = <span class="ruby-constant">Mail</span>.<span class="ruby-identifier">new</span>&#x000A;  <span class="ruby-identifier">m</span>.<span class="ruby-identifier">from</span> = <span class="ruby-identifier">email_from</span>&#x000A;  <span class="ruby-identifier">m</span>.<span class="ruby-identifier">to</span> = <span class="ruby-identifier">to</span>&#x000A;  <span class="ruby-identifier">m</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-node">&quot;#{email_subject_prefix}#{subject}&quot;</span>&#x000A;  <span class="ruby-identifier">m</span>.<span class="ruby-identifier">body</span> = <span class="ruby-identifier">body</span>&#x000A;  <span class="ruby-identifier">m</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_password_changed_email'>
<a name='method-i-create_password_changed_email'></a>
<div class='synopsis'>
<span class='name'>create_password_changed_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_password_changed_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_password_changed_email-source'><span class="ruby-comment"># File lib/rodauth/features/change_password_notify.rb, line 22</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_password_changed_email</span>&#x000A;  <span class="ruby-identifier">create_email</span>(<span class="ruby-identifier">password_changed_email_subject</span>, <span class="ruby-identifier">password_changed_email_body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_reset_password_email'>
<a name='method-i-create_reset_password_email'></a>
<div class='synopsis'>
<span class='name'>create_reset_password_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_reset_password_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_reset_password_email-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 235</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_reset_password_email</span>&#x000A;  <span class="ruby-identifier">create_email</span>(<span class="ruby-identifier">reset_password_email_subject</span>, <span class="ruby-identifier">reset_password_email_body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_reset_password_key'>
<a name='method-i-create_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>create_reset_password_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_reset_password_key-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 156</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_reset_password_key</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">reset_password_key_value</span> = <span class="ruby-identifier">get_password_reset_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;      <span class="ruby-identifier">set_reset_password_email_last_sent</span>&#x000A;      <span class="ruby-ivar">@reset_password_key_value</span> = <span class="ruby-identifier">reset_password_key_value</span>&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">reset_password_key_insert_hash</span>)}&#x000A;      <span class="ruby-comment"># If inserting into the reset password table causes a violation, we can pull the</span>&#x000A;      <span class="ruby-comment"># existing reset password key from the table, or reraise.</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@reset_password_key_value</span> = <span class="ruby-identifier">get_password_reset_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_unlock_account_email'>
<a name='method-i-create_unlock_account_email'></a>
<div class='synopsis'>
<span class='name'>create_unlock_account_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_unlock_account_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_unlock_account_email-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 277</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_unlock_account_email</span>&#x000A;  <span class="ruby-identifier">create_email</span>(<span class="ruby-identifier">unlock_account_email_subject</span>, <span class="ruby-identifier">unlock_account_email_body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_account_email'>
<a name='method-i-create_verify_account_email'></a>
<div class='synopsis'>
<span class='name'>create_verify_account_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_account_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_account_email-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 296</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_account_email</span>&#x000A;  <span class="ruby-identifier">create_email</span>(<span class="ruby-identifier">verify_account_email_subject</span>, <span class="ruby-identifier">verify_account_email_body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_account_key'>
<a name='method-i-create_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>create_verify_account_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 279</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_account_key</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">verify_account_ds</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">empty?</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">verify_account_key_insert_hash</span>)}&#x000A;        <span class="ruby-comment"># If inserting into the verify account table causes a violation, we can pull the</span>&#x000A;        <span class="ruby-comment"># key from the verify account table, or reraise.</span>&#x000A;        <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@verify_account_key_value</span> = <span class="ruby-identifier">get_verify_account_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_login_change_email'>
<a name='method-i-create_verify_login_change_email'></a>
<div class='synopsis'>
<span class='name'>create_verify_login_change_email</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_login_change_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_login_change_email-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 191</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_login_change_email</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">create_email_to</span>(<span class="ruby-identifier">login</span>, <span class="ruby-identifier">verify_login_change_email_subject</span>, <span class="ruby-identifier">verify_login_change_email_body</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_login_change_key'>
<a name='method-i-create_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>create_verify_login_change_key</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_login_change_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 169</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_login_change_key</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">verify_login_change_ds</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>((<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">verify_login_change_deadline_column</span>) <span class="ruby-operator">|</span> <span class="ruby-operator">~</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">verify_login_change_login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>)).<span class="ruby-identifier">delete</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">verify_login_change_key_insert_hash</span>(<span class="ruby-identifier">login</span>))}&#x000A;      <span class="ruby-identifier">old_login</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">get_verify_login_change_login_and_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;      <span class="ruby-comment"># If inserting into the verify login change table causes a violation, we can pull the</span>&#x000A;      <span class="ruby-comment"># key from the verify login change table if the logins match, or reraise.</span>&#x000A;      <span class="ruby-ivar">@verify_login_change_key_value</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">old_login</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">downcase</span>&#x000A;        <span class="ruby-identifier">key</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@verify_login_change_key_value</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-csrf_tag'>
<a name='method-i-csrf_tag'></a>
<div class='synopsis'>
<span class='name'>csrf_tag</span>
<span class='arguments'>(path=request.path)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-csrf_tag-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-csrf_tag-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 239</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">csrf_tag</span>(<span class="ruby-identifier">path</span>=<span class="ruby-identifier">request</span>.<span class="ruby-identifier">path</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:csrf_tag</span>)&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_request_specific_csrf_tokens?</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">csrf_tag</span>(<span class="ruby-identifier">path</span>)&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">csrf_tag</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-currently_active_session-3F'>
<a name='method-i-currently_active_session-3F'></a>
<div class='synopsis'>
<span class='name'>currently_active_session?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-currently_active_session-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-currently_active_session-3F-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 25</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">currently_active_session?</span>&#x000A;  <span class="ruby-identifier">single_session_key</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">single_session_session_key</span>]&#x000A;  <span class="ruby-identifier">current_key</span> = <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">single_session_key_column</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">single_session_key</span>.<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">current_key</span>&#x000A;      <span class="ruby-comment"># No row exists for this user, indicating the feature has never</span>&#x000A;      <span class="ruby-comment"># been used, so it is OK to treat the current session as a new</span>&#x000A;      <span class="ruby-comment"># session.</span>&#x000A;      <span class="ruby-identifier">update_single_session_key</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">current_key</span>&#x000A;    <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">single_session_key</span>, <span class="ruby-identifier">current_key</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-db'>
<a name='method-i-db'></a>
<div class='synopsis'>
<span class='name'>db</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-db-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-db-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 164</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">db</span>&#x000A;  <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">DATABASES</span>.<span class="ruby-identifier">first</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-delete_account'>
<a name='method-i-delete_account'></a>
<div class='synopsis'>
<span class='name'>delete_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-delete_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-delete_account-source'><span class="ruby-comment"># File lib/rodauth/features/close_account.rb, line 71</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete_account</span>&#x000A;  <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-delete_account_on_close-3F'>
<a name='method-i-delete_account_on_close-3F'></a>
<div class='synopsis'>
<span class='name'>delete_account_on_close?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-delete_account_on_close-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-delete_account_on_close-3F-source'><span class="ruby-comment"># File lib/rodauth/features/close_account.rb, line 75</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete_account_on_close?</span>&#x000A;  <span class="ruby-identifier">skip_status_checks?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-disable_remember_login'>
<a name='method-i-disable_remember_login'></a>
<div class='synopsis'>
<span class='name'>disable_remember_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-disable_remember_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-disable_remember_login-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 139</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">disable_remember_login</span>&#x000A;  <span class="ruby-identifier">remove_remember_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_ds'>
<a name='method-i-email_auth_ds'></a>
<div class='synopsis'>
<span class='name'>email_auth_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_ds-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 244</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">email_auth_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">email_auth_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_email_body'>
<a name='method-i-email_auth_email_body'></a>
<div class='synopsis'>
<span class='name'>email_auth_email_body</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_email_body-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 230</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_email_body</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;email-auth-email&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_email_link'>
<a name='method-i-email_auth_email_link'></a>
<div class='synopsis'>
<span class='name'>email_auth_email_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_email_link-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 138</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_email_link</span>&#x000A;  <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">email_auth_route</span>, <span class="ruby-identifier">email_auth_key_param</span>, <span class="ruby-identifier">email_auth_key_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_email_recently_sent-3F'>
<a name='method-i-email_auth_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>email_auth_email_recently_sent?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_email_recently_sent-3F-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 182</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_email_recently_sent?</span>&#x000A;  (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_email_auth_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">email_auth_skip_resend_email_within</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_key_insert_hash'>
<a name='method-i-email_auth_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>email_auth_key_insert_hash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_key_insert_hash-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 238</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_key_insert_hash</span>&#x000A;  <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">email_auth_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">email_auth_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">email_auth_key_value</span>}&#x000A;  <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">email_auth_deadline_column</span>, <span class="ruby-identifier">email_auth_deadline_interval</span>)&#x000A;  <span class="ruby-identifier">hash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_request_form'>
<a name='method-i-email_auth_request_form'></a>
<div class='synopsis'>
<span class='name'>email_auth_request_form</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_request_form-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_request_form-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 154</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_request_form</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;email-auth-request-form&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_from'>
<a name='method-i-email_from'></a>
<div class='synopsis'>
<span class='name'>email_from</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_from-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_from-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 39</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_from</span>&#x000A;  <span class="ruby-node">&quot;webmaster@#{request.host}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_to'>
<a name='method-i-email_to'></a>
<div class='synopsis'>
<span class='name'>email_to</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_to-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_to-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 43</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_to</span>&#x000A;  <span class="ruby-identifier">account</span>[<span class="ruby-identifier">login_column</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-expire_session'>
<a name='method-i-expire_session'></a>
<div class='synopsis'>
<span class='name'>expire_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-expire_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-expire_session-source'><span class="ruby-comment"># File lib/rodauth/features/session_expiration.rb, line 37</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">expire_session</span>&#x000A;  <span class="ruby-identifier">clear_session</span>&#x000A;  <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">session_expiration_error_flash</span>&#x000A;  <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">session_expiration_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-features'>
<a name='method-i-features'></a>
<div class='synopsis'>
<span class='name'>features</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-features-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-features-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 109</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">features</span>&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">features</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-field_error'>
<a name='method-i-field_error'></a>
<div class='synopsis'>
<span class='name'>field_error</span>
<span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-field_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-field_error-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 141</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">field_error</span>(<span class="ruby-identifier">field</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@field_errors</span>&#x000A;  <span class="ruby-ivar">@field_errors</span>[<span class="ruby-identifier">field</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-flash'>
<a name='method-i-flash'></a>
<div class='synopsis'>
<span class='name'>flash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-flash-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 125</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">flash</span>&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">flash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-force_email_auth-3F'>
<a name='method-i-force_email_auth-3F'></a>
<div class='synopsis'>
<span class='name'>force_email_auth?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-force_email_auth-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-force_email_auth-3F-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 176</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">force_email_auth?</span>&#x000A;  <span class="ruby-identifier">get_password_hash</span>.<span class="ruby-identifier">nil?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-forget_login'>
<a name='method-i-forget_login'></a>
<div class='synopsis'>
<span class='name'>forget_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-forget_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-forget_login-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 124</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">forget_login</span>&#x000A;  <span class="ruby-operator">::</span><span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">delete_cookie_header!</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>, <span class="ruby-identifier">remember_cookie_key</span>, <span class="ruby-identifier">remember_cookie_options</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-function_name'>
<a name='method-i-function_name'></a>
<div class='synopsis'>
<span class='name'>function_name</span>
<span class='arguments'>(name)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-function_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-function_name-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 403</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">function_name</span>(<span class="ruby-identifier">name</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:mssql</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-node">&quot;dbo.#{name}&quot;</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">name</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_email_auth_key_value'>
<a name='method-i-generate_email_auth_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_email_auth_key_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_email_auth_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_email_auth_key_value-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 222</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_email_auth_key_value</span>&#x000A;  <span class="ruby-ivar">@email_auth_key_value</span> = <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_remember_key_value'>
<a name='method-i-generate_remember_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_remember_key_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_remember_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_remember_key_value-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 185</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_remember_key_value</span>&#x000A;  <span class="ruby-ivar">@remember_key_value</span> = <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_reset_password_key_value'>
<a name='method-i-generate_reset_password_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_reset_password_key_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_reset_password_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_reset_password_key_value-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 231</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_reset_password_key_value</span>&#x000A;  <span class="ruby-ivar">@reset_password_key_value</span> = <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_unlock_account_key'>
<a name='method-i-generate_unlock_account_key'></a>
<div class='synopsis'>
<span class='name'>generate_unlock_account_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_unlock_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_unlock_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 261</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_unlock_account_key</span>&#x000A;  <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_verify_account_key_value'>
<a name='method-i-generate_verify_account_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_verify_account_key_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_verify_account_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_verify_account_key_value-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 275</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_verify_account_key_value</span>&#x000A;  <span class="ruby-ivar">@verify_account_key_value</span> = <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_verify_login_change_key_value'>
<a name='method-i-generate_verify_login_change_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_verify_login_change_key_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_verify_login_change_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_verify_login_change_key_value-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 165</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_verify_login_change_key_value</span>&#x000A;  <span class="ruby-ivar">@verify_login_change_key_value</span> = <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_activity_timestamp'>
<a name='method-i-get_activity_timestamp'></a>
<div class='synopsis'>
<span class='name'>get_activity_timestamp</span>
<span class='arguments'>(account_id, column)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_activity_timestamp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_activity_timestamp-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 108</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_activity_timestamp</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">column</span>)&#x000A;  <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_email_auth_email_last_sent'>
<a name='method-i-get_email_auth_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_email_auth_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_email_auth_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_email_auth_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 118</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_email_auth_email_last_sent</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">email_auth_email_last_sent_column</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_email_auth_key'>
<a name='method-i-get_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>get_email_auth_key</span>
<span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_email_auth_key-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 142</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_email_auth_key</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">email_auth_ds</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">email_auth_deadline_column</span>).<span class="ruby-identifier">delete</span>&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">email_auth_key_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_password_changed_at'>
<a name='method-i-get_password_changed_at'></a>
<div class='synopsis'>
<span class='name'>get_password_changed_at</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_password_changed_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_password_changed_at-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 25</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_password_changed_at</span>&#x000A;  <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">password_expiration_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">password_expiration_changed_at_column</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_password_hash'>
<a name='method-i-get_password_hash'></a>
<div class='synopsis'>
<span class='name'>get_password_hash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Get the password hash for the user.  When using database authentication
functions, note that only the salt is returned.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_password_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_password_hash-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 415</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_password_hash</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_password_hash_column</span>&#x000A;    <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_password_hash_column</span>]&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">use_database_authentication_functions?</span>&#x000A;    <span class="ruby-identifier">db</span>.<span class="ruby-identifier">get</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-value">:rodauth_get_salt</span>), <span class="ruby-identifier">account_id</span>))&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-identifier">password_hash_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">password_hash_column</span>)&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_password_reset_key'>
<a name='method-i-get_password_reset_key'></a>
<div class='synopsis'>
<span class='name'>get_password_reset_key</span>
<span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_password_reset_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_password_reset_key-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 185</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_password_reset_key</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">password_reset_ds</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">reset_password_deadline_column</span>).<span class="ruby-identifier">delete</span>&#x000A;  <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">reset_password_key_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_remember_key'>
<a name='method-i-get_remember_key'></a>
<div class='synopsis'>
<span class='name'>get_remember_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_remember_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_remember_key-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 128</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_remember_key</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@remember_key_value</span> = <span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_key_column</span>)&#x000A;   <span class="ruby-identifier">generate_remember_key_value</span>&#x000A;   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;     <span class="ruby-identifier">remove_remember_key</span>&#x000A;     <span class="ruby-identifier">add_remember_key</span>&#x000A;   <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_reset_password_email_last_sent'>
<a name='method-i-get_reset_password_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_reset_password_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_reset_password_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_reset_password_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 203</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_reset_password_email_last_sent</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">reset_password_email_last_sent_column</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_unlock_account_email_last_sent'>
<a name='method-i-get_unlock_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_unlock_account_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_unlock_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_unlock_account_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 223</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_unlock_account_email_last_sent</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">account_lockouts_email_last_sent_column</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_unlock_account_key'>
<a name='method-i-get_unlock_account_key'></a>
<div class='synopsis'>
<span class='name'>get_unlock_account_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_unlock_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_unlock_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 206</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_unlock_account_key</span>&#x000A;  <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_key_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_verify_account_email_last_sent'>
<a name='method-i-get_verify_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_verify_account_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_verify_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_verify_account_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 234</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_verify_account_email_last_sent</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">verify_account_email_last_sent_column</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)&#x000A;      <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_verify_account_key'>
<a name='method-i-get_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>get_verify_account_key</span>
<span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_verify_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 205</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_verify_account_key</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">verify_account_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">verify_account_key_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_verify_login_change_login_and_key'>
<a name='method-i-get_verify_login_change_login_and_key'></a>
<div class='synopsis'>
<span class='name'>get_verify_login_change_login_and_key</span>
<span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_verify_login_change_login_and_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_verify_login_change_login_and_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 125</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_verify_login_change_login_and_key</span>(<span class="ruby-identifier">id</span>)&#x000A;  <span class="ruby-identifier">verify_login_change_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>([<span class="ruby-identifier">verify_login_change_login_column</span>, <span class="ruby-identifier">verify_login_change_key_column</span>])&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-include_success_messages-3F'>
<a name='method-i-include_success_messages-3F'></a>
<div class='synopsis'>
<span class='name'>include_success_messages?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-include_success_messages-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-include_success_messages-3F-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 187</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">include_success_messages?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-identifier">json_response_success_key</span>.<span class="ruby-identifier">nil?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-invalid_login_attempted'>
<a name='method-i-invalid_login_attempted'></a>
<div class='synopsis'>
<span class='name'>invalid_login_attempted</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-invalid_login_attempted-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-invalid_login_attempted-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 164</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">invalid_login_attempted</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_login_failures_ds</span>.&#x000A;      <span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_login_failures_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)&#x000A;&#x000A;  <span class="ruby-identifier">number</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:postgres</span>&#x000A;    <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">returning</span>(<span class="ruby-identifier">account_login_failures_number_column</span>).&#x000A;      <span class="ruby-identifier">with_sql</span>(<span class="ruby-value">:update_sql</span>, <span class="ruby-identifier">account_login_failures_number_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">account_login_failures_number_column</span>)<span class="ruby-value">+1</span>).&#x000A;      <span class="ruby-identifier">single_value</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">account_login_failures_number_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">account_login_failures_number_column</span>)<span class="ruby-value">+1</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>&#x000A;      <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_login_failures_number_column</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">number</span>&#x000A;    <span class="ruby-comment"># Ignoring the violation is safe here.  It may allow slightly more than max_invalid_logins invalid logins before</span>&#x000A;    <span class="ruby-comment"># lockout, but allowing a few extra is OK if the race is lost.</span>&#x000A;    <span class="ruby-identifier">ignore_uniqueness_violation</span>{<span class="ruby-identifier">account_login_failures_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">account_login_failures_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)}&#x000A;    <span class="ruby-identifier">number</span> = <span class="ruby-value">1</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">number</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">max_invalid_logins</span>&#x000A;    <span class="ruby-ivar">@unlock_account_key_value</span> = <span class="ruby-identifier">generate_unlock_account_key</span>&#x000A;    <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">account_lockouts_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_lockouts_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">unlock_account_key_value</span>}&#x000A;    <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">account_lockouts_deadline_column</span>, <span class="ruby-identifier">account_lockouts_deadline_interval</span>)&#x000A;&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)}&#x000A;      <span class="ruby-comment"># If inserting into the lockout table raises a violation, we should just be able to pull the already inserted</span>&#x000A;      <span class="ruby-comment"># key out of it.  If that doesn&#39;t return a valid key, we should reraise the error.</span>&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@unlock_account_key_value</span> = <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_key_column</span>)&#x000A;&#x000A;      <span class="ruby-identifier">after_account_lockout</span>&#x000A;      <span class="ruby-identifier">show_lockout_page</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">after_account_lockout</span>&#x000A;      <span class="ruby-identifier">e</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-invalid_previous_password_message'>
<a name='method-i-invalid_previous_password_message'></a>
<div class='synopsis'>
<span class='name'>invalid_previous_password_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-invalid_previous_password_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-invalid_previous_password_message-source'><span class="ruby-comment"># File lib/rodauth/features/change_password.rb, line 69</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">invalid_previous_password_message</span>&#x000A;  <span class="ruby-identifier">invalid_password_message</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-json_request-3F'>
<a name='method-i-json_request-3F'></a>
<div class='synopsis'>
<span class='name'>json_request?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-json_request-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-json_request-3F-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 103</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">json_request?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@json_request</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@json_request</span>)&#x000A;  <span class="ruby-ivar">@json_request</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">json_request_content_type_regexp</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-json_response'>
<a name='method-i-json_response'></a>
<div class='synopsis'>
<span class='name'>json_response</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-json_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-json_response-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 197</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">json_response</span>&#x000A;  <span class="ruby-ivar">@json_response</span> <span class="ruby-operator">||=</span> {}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_payload'>
<a name='method-i-jwt_payload'></a>
<div class='synopsis'>
<span class='name'>jwt_payload</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_payload-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_payload-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 175</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_payload</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@jwt_payload</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@jwt_payload</span>)&#x000A;  <span class="ruby-ivar">@jwt_payload</span> = <span class="ruby-constant">JWT</span>.<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">jwt_token</span>, <span class="ruby-identifier">jwt_secret</span>, <span class="ruby-keyword">true</span>, <span class="ruby-identifier">jwt_decode_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:algorithm</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">jwt_algorithm</span>))[<span class="ruby-value">0</span>]&#x000A;<span class="ruby-keyword">rescue</span> <span class="ruby-constant">JWT</span><span class="ruby-operator">::</span><span class="ruby-constant">DecodeError</span>&#x000A;  <span class="ruby-ivar">@jwt_payload</span> = <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_secret'>
<a name='method-i-jwt_secret'></a>
<div class='synopsis'>
<span class='name'>jwt_secret</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_secret-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 108</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_secret</span>&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;jwt_secret not set&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_session_hash'>
<a name='method-i-jwt_session_hash'></a>
<div class='synopsis'>
<span class='name'>jwt_session_hash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_session_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_session_hash-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 112</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_session_hash</span>&#x000A;  <span class="ruby-identifier">jwt_session_key</span> <span class="ruby-operator">?</span> {<span class="ruby-identifier">jwt_session_key</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session</span>} <span class="ruby-operator">:</span> <span class="ruby-identifier">session</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_token'>
<a name='method-i-jwt_token'></a>
<div class='synopsis'>
<span class='name'>jwt_token</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_token-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 120</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_token</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@jwt_token</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@jwt_token</span>)&#x000A;&#x000A;  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_AUTHORIZATION&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">jwt_authorization_ignore</span>&#x000A;    <span class="ruby-ivar">@jwt_token</span> = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">jwt_authorization_remove</span>, <span class="ruby-string">&#39;&#39;</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-last_account_activity_at'>
<a name='method-i-last_account_activity_at'></a>
<div class='synopsis'>
<span class='name'>last_account_activity_at</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-last_account_activity_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-last_account_activity_at-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 26</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last_account_activity_at</span>&#x000A;  <span class="ruby-identifier">get_activity_timestamp</span>(<span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">account_activity_last_activity_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-last_account_login_at'>
<a name='method-i-last_account_login_at'></a>
<div class='synopsis'>
<span class='name'>last_account_login_at</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-last_account_login_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-last_account_login_at-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 30</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last_account_login_at</span>&#x000A;  <span class="ruby-identifier">get_activity_timestamp</span>(<span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">account_activity_last_login_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-load_memory'>
<a name='method-i-load_memory'></a>
<div class='synopsis'>
<span class='name'>load_memory</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-load_memory-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-load_memory-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 84</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_memory</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_key</span>]&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cookie</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">remember_cookie_key</span>]&#x000A;  <span class="ruby-identifier">id</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">cookie</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;_&#39;</span>, <span class="ruby-value">2</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span>&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">actual</span> = <span class="ruby-identifier">active_remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_key_column</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">actual</span>)&#x000A;    <span class="ruby-identifier">forget_login</span>&#x000A;    <span class="ruby-keyword">return</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_key</span>] = <span class="ruby-identifier">id</span>&#x000A;  <span class="ruby-identifier">account</span> = <span class="ruby-identifier">account_from_session</span>&#x000A;  <span class="ruby-identifier">session</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">session_key</span>)&#x000A;&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account</span>&#x000A;    <span class="ruby-identifier">remove_remember_key</span>(<span class="ruby-identifier">id</span>)&#x000A;    <span class="ruby-identifier">forget_login</span>&#x000A;    <span class="ruby-keyword">return</span> &#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">before_load_memory</span>&#x000A;  <span class="ruby-identifier">update_session</span>&#x000A;&#x000A;  <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">remembered_session_key</span>, <span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">extend_remember_deadline?</span>&#x000A;    <span class="ruby-identifier">active_remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">remember_deadline_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-identifier">remember_period</span>))&#x000A;    <span class="ruby-identifier">remember_login</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">after_load_memory</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-loaded_templates'>
<a name='method-i-loaded_templates'></a>
<div class='synopsis'>
<span class='name'>loaded_templates</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-loaded_templates-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-loaded_templates-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 465</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">loaded_templates</span>&#x000A;  []&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-locked_out-3F'>
<a name='method-i-locked_out-3F'></a>
<div class='synopsis'>
<span class='name'>locked_out?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-locked_out-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-locked_out-3F-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 141</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">locked_out?</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span> = <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_deadline_column</span>))&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">t</span>&#x000A;      <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">unlock_account</span>&#x000A;      <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-logged_in_via_remember_key-3F'>
<a name='method-i-logged_in_via_remember_key-3F'></a>
<div class='synopsis'>
<span class='name'>logged_in_via_remember_key?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-logged_in_via_remember_key-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-logged_in_via_remember_key-3F-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 162</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">logged_in_via_remember_key?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">remembered_session_key</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_confirm_label'>
<a name='method-i-login_confirm_label'></a>
<div class='synopsis'>
<span class='name'>login_confirm_label</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_confirm_label-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_confirm_label-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 34</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_confirm_label</span>&#x000A;  <span class="ruby-node">&quot;Confirm #{login_label}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_does_not_meet_requirements_message'>
<a name='method-i-login_does_not_meet_requirements_message'></a>
<div class='synopsis'>
<span class='name'>login_does_not_meet_requirements_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_does_not_meet_requirements_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_does_not_meet_requirements_message-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 79</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_does_not_meet_requirements_message</span>&#x000A;  <span class="ruby-node">&quot;invalid login#{&quot;, #{login_requirement_message}&quot; if login_requirement_message}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_failed_reset_password_request_form'>
<a name='method-i-login_failed_reset_password_request_form'></a>
<div class='synopsis'>
<span class='name'>login_failed_reset_password_request_form</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_failed_reset_password_request_form-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_failed_reset_password_request_form-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 239</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_failed_reset_password_request_form</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&quot;reset-password-request&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_form_footer'>
<a name='method-i-login_form_footer'></a>
<div class='synopsis'>
<span class='name'>login_form_footer</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_form_footer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_form_footer-source'><span class="ruby-comment"># File lib/rodauth/features/create_account.rb, line 94</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_form_footer</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">create_account_link</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_hidden_field'>
<a name='method-i-login_hidden_field'></a>
<div class='synopsis'>
<span class='name'>login_hidden_field</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_hidden_field-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_hidden_field-source'><span class="ruby-comment"># File lib/rodauth/features/login.rb, line 79</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_hidden_field</span>&#x000A;  <span class="ruby-node">&quot;&lt;input type=&#39;hidden&#39; name=\&quot;#{login_param}\&quot; value=\&quot;#{scope.h param(login_param)}\&quot; /&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_meets_email_requirements-3F'>
<a name='method-i-login_meets_email_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>login_meets_email_requirements?</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_meets_email_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_meets_email_requirements-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 103</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_meets_email_requirements?</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">require_email_address_logins?</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">login</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\A[^,;@ \r\n]+@[^,@; \r\n]+\.[^,@; \r\n]+\z/</span>&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-string">&#39;not a valid email address&#39;</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_meets_length_requirements-3F'>
<a name='method-i-login_meets_length_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>login_meets_length_requirements?</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_meets_length_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_meets_length_requirements-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 91</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_meets_length_requirements?</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">login_minimum_length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">length</span>&#x000A;    <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-identifier">login_too_short_message</span>&#x000A;    <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">login_maximum_length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">length</span>&#x000A;    <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-identifier">login_too_long_message</span>&#x000A;    <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_meets_requirements-3F'>
<a name='method-i-login_meets_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>login_meets_requirements?</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_meets_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_meets_requirements-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 42</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_meets_requirements?</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">login_meets_length_requirements?</span>(<span class="ruby-identifier">login</span>) <span class="ruby-operator">&amp;&amp;</span> \&#x000A;    <span class="ruby-identifier">login_meets_email_requirements?</span>(<span class="ruby-identifier">login</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_required'>
<a name='method-i-login_required'></a>
<div class='synopsis'>
<span class='name'>login_required</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_required-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_required-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 191</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_required</span>&#x000A;  <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">login_required_error_status</span>)&#x000A;  <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">require_login_error_flash</span>&#x000A;  <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">require_login_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_too_long_message'>
<a name='method-i-login_too_long_message'></a>
<div class='synopsis'>
<span class='name'>login_too_long_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_too_long_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_too_long_message-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 83</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_too_long_message</span>&#x000A;  <span class="ruby-node">&quot;maximum #{login_maximum_length} characters&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_too_short_message'>
<a name='method-i-login_too_short_message'></a>
<div class='synopsis'>
<span class='name'>login_too_short_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_too_short_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_too_short_message-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 87</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_too_short_message</span>&#x000A;  <span class="ruby-node">&quot;minimum #{login_minimum_length} characters&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-logout'>
<a name='method-i-logout'></a>
<div class='synopsis'>
<span class='name'>logout</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-logout-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-logout-source'><span class="ruby-comment"># File lib/rodauth/features/logout.rb, line 33</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">logout</span>&#x000A;  <span class="ruby-identifier">clear_session</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-modifications_require_password-3F'>
<a name='method-i-modifications_require_password-3F'></a>
<div class='synopsis'>
<span class='name'>modifications_require_password?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-modifications_require_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-modifications_require_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb, line 7</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">modifications_require_password?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-identifier">password_recently_entered?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-new_account'>
<a name='method-i-new_account'></a>
<div class='synopsis'>
<span class='name'>new_account</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-new_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-new_account-source'><span class="ruby-comment"># File lib/rodauth/features/create_account.rb, line 102</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new_account</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_new_account</span>(<span class="ruby-identifier">login</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-new_recovery_code'>
<a name='method-i-new_recovery_code'></a>
<div class='synopsis'>
<span class='name'>new_recovery_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-new_recovery_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-new_recovery_code-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 224</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new_recovery_code</span>&#x000A;  <span class="ruby-identifier">random_key</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-no_longer_active_session'>
<a name='method-i-no_longer_active_session'></a>
<div class='synopsis'>
<span class='name'>no_longer_active_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-no_longer_active_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-no_longer_active_session-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 47</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">no_longer_active_session</span>&#x000A;  <span class="ruby-identifier">clear_session</span>&#x000A;  <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">single_session_error_flash</span>&#x000A;  <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">single_session_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-only_json-3F'>
<a name='method-i-only_json-3F'></a>
<div class='synopsis'>
<span class='name'>only_json?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-only_json-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-only_json-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 273</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">only_json?</span>&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:only</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-open_account-3F'>
<a name='method-i-open_account-3F'></a>
<div class='synopsis'>
<span class='name'>open_account?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-open_account-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-open_account-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 160</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">open_account?</span>&#x000A;  <span class="ruby-identifier">skip_status_checks?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_status_column</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">account_open_status_value</span> &#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_add_key'>
<a name='method-i-otp_add_key'></a>
<div class='synopsis'>
<span class='name'>otp_add_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_add_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_add_key-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 267</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_add_key</span>&#x000A;  <span class="ruby-identifier">_otp_add_key</span>(<span class="ruby-identifier">otp_key</span>)&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_auth_form_footer'>
<a name='method-i-otp_auth_form_footer'></a>
<div class='synopsis'>
<span class='name'>otp_auth_form_footer</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_auth_form_footer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_auth_form_footer-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 227</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_auth_form_footer</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_exists-3F'>
<a name='method-i-otp_exists-3F'></a>
<div class='synopsis'>
<span class='name'>otp_exists?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_exists-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_exists-3F-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 248</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_exists?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-identifier">otp_key</span>.<span class="ruby-identifier">nil?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_issuer'>
<a name='method-i-otp_issuer'></a>
<div class='synopsis'>
<span class='name'>otp_issuer</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_issuer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_issuer-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 294</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_issuer</span>&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">host</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_key_ds'>
<a name='method-i-otp_key_ds'></a>
<div class='synopsis'>
<span class='name'>otp_key_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_key_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_key_ds-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 343</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_key_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">otp_keys_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">otp_keys_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_locked_out-3F'>
<a name='method-i-otp_locked_out-3F'></a>
<div class='synopsis'>
<span class='name'>otp_locked_out?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_locked_out-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_locked_out-3F-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 286</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_locked_out?</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">otp_keys_failures_column</span>) <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">otp_auth_failures_limit</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_lockout_error_flash'>
<a name='method-i-otp_lockout_error_flash'></a>
<div class='synopsis'>
<span class='name'>otp_lockout_error_flash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_lockout_error_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_lockout_error_flash-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 236</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_lockout_error_flash</span>&#x000A;  <span class="ruby-node">&quot;Authentication code use locked out due to numerous failures.#{super if defined?(super)}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_lockout_redirect'>
<a name='method-i-otp_lockout_redirect'></a>
<div class='synopsis'>
<span class='name'>otp_lockout_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_lockout_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_lockout_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 231</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_lockout_redirect</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;  <span class="ruby-identifier">default_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_new_secret'>
<a name='method-i-otp_new_secret'></a>
<div class='synopsis'>
<span class='name'>otp_new_secret</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_new_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_new_secret-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 321</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_new_secret</span>&#x000A;  <span class="ruby-constant">ROTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Base32</span>.<span class="ruby-identifier">random_base32</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_provisioning_name'>
<a name='method-i-otp_provisioning_name'></a>
<div class='synopsis'>
<span class='name'>otp_provisioning_name</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_provisioning_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_provisioning_name-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 298</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_provisioning_name</span>&#x000A;  <span class="ruby-identifier">account</span>[<span class="ruby-identifier">login_column</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_provisioning_uri'>
<a name='method-i-otp_provisioning_uri'></a>
<div class='synopsis'>
<span class='name'>otp_provisioning_uri</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_provisioning_uri-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_provisioning_uri-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 290</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_provisioning_uri</span>&#x000A;  <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">provisioning_uri</span>(<span class="ruby-identifier">otp_provisioning_name</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_qr_code'>
<a name='method-i-otp_qr_code'></a>
<div class='synopsis'>
<span class='name'>otp_qr_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_qr_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_qr_code-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 302</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_qr_code</span>&#x000A;  <span class="ruby-constant">RQRCode</span><span class="ruby-operator">::</span><span class="ruby-constant">QRCode</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">otp_provisioning_uri</span>).<span class="ruby-identifier">as_svg</span>(<span class="ruby-value">:module_size</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">8</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_record_authentication_failure'>
<a name='method-i-otp_record_authentication_failure'></a>
<div class='synopsis'>
<span class='name'>otp_record_authentication_failure</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_record_authentication_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_record_authentication_failure-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 278</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_record_authentication_failure</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_failures_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">identifier</span>(<span class="ruby-identifier">otp_keys_failures_column</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_remove'>
<a name='method-i-otp_remove'></a>
<div class='synopsis'>
<span class='name'>otp_remove</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_remove-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 262</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_remove</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_remove_auth_failures'>
<a name='method-i-otp_remove_auth_failures'></a>
<div class='synopsis'>
<span class='name'>otp_remove_auth_failures</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_remove_auth_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_remove_auth_failures-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 282</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_remove_auth_failures</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_failures_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">0</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_tmp_key'>
<a name='method-i-otp_tmp_key'></a>
<div class='synopsis'>
<span class='name'>otp_tmp_key</span>
<span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_tmp_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_tmp_key-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 312</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_tmp_key</span>(<span class="ruby-identifier">secret</span>)&#x000A;  <span class="ruby-identifier">_otp_tmp_key</span>(<span class="ruby-identifier">secret</span>)&#x000A;  <span class="ruby-identifier">clear_cached_otp</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_update_last_use'>
<a name='method-i-otp_update_last_use'></a>
<div class='synopsis'>
<span class='name'>otp_update_last_use</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_update_last_use-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_update_last_use-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 272</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_update_last_use</span>&#x000A;  <span class="ruby-identifier">otp_key_ds</span>.&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-identifier">otp_keys_last_use_column</span>, <span class="ruby-value">:seconds</span><span class="ruby-operator">=&gt;</span>(<span class="ruby-identifier">otp_interval</span><span class="ruby-operator">||</span><span class="ruby-value">30</span>)) <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>).&#x000A;    <span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_last_use_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_valid_code-3F'>
<a name='method-i-otp_valid_code-3F'></a>
<div class='synopsis'>
<span class='name'>otp_valid_code?</span>
<span class='arguments'>(ot_pass)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_valid_code-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_valid_code-3F-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 252</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_valid_code?</span>(<span class="ruby-identifier">ot_pass</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">otp_exists?</span>&#x000A;  <span class="ruby-identifier">ot_pass</span> = <span class="ruby-identifier">ot_pass</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\s+/</span>, <span class="ruby-string">&#39;&#39;</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">drift</span> = <span class="ruby-identifier">otp_drift</span>&#x000A;    <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">verify_with_drift</span>(<span class="ruby-identifier">ot_pass</span>, <span class="ruby-identifier">drift</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">verify</span>(<span class="ruby-identifier">ot_pass</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_valid_key-3F'>
<a name='method-i-otp_valid_key-3F'></a>
<div class='synopsis'>
<span class='name'>otp_valid_key?</span>
<span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_valid_key-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_valid_key-3F-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 317</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_valid_key?</span>(<span class="ruby-identifier">secret</span>)&#x000A;  <span class="ruby-identifier">secret</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\A[a-z2-7]{16}\z/</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-param'>
<a name='method-i-param'></a>
<div class='synopsis'>
<span class='name'>param</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>Return a string for the parameter name.  This will be an empty string if
the parameter doesn&#39;t exist.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-param-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-param-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 304</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">param</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">to_s</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-param_or_nil'>
<a name='method-i-param_or_nil'></a>
<div class='synopsis'>
<span class='name'>param_or_nil</span>
<span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>Return a string for the parameter name, or nil if there is no parameter
with that name.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-param_or_nil-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-param_or_nil-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 310</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">param_or_nil</span>(<span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-identifier">value</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>]&#x000A;  <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_changed_email_body'>
<a name='method-i-password_changed_email_body'></a>
<div class='synopsis'>
<span class='name'>password_changed_email_body</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_changed_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_changed_email_body-source'><span class="ruby-comment"># File lib/rodauth/features/change_password_notify.rb, line 26</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_changed_email_body</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;password-changed-email&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_confirm_label'>
<a name='method-i-password_confirm_label'></a>
<div class='synopsis'>
<span class='name'>password_confirm_label</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_confirm_label-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_confirm_label-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 38</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_confirm_label</span>&#x000A;  <span class="ruby-node">&quot;Confirm #{password_label}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_does_not_contain_null_byte-3F'>
<a name='method-i-password_does_not_contain_null_byte-3F'></a>
<div class='synopsis'>
<span class='name'>password_does_not_contain_null_byte?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_does_not_contain_null_byte-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_does_not_contain_null_byte-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 118</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_does_not_contain_null_byte?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;\0&quot;</span>)&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-string">&#39;contains null byte&#39;</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_does_not_meet_requirements_message'>
<a name='method-i-password_does_not_meet_requirements_message'></a>
<div class='synopsis'>
<span class='name'>password_does_not_meet_requirements_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_does_not_meet_requirements_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_does_not_meet_requirements_message-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 71</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_does_not_meet_requirements_message</span>&#x000A;  <span class="ruby-node">&quot;invalid password, does not meet requirements#{&quot; (#{password_requirement_message})&quot; if password_requirement_message}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_doesnt_match_previous_password-3F'>
<a name='method-i-password_doesnt_match_previous_password-3F'></a>
<div class='synopsis'>
<span class='name'>password_doesnt_match_previous_password?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_doesnt_match_previous_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_doesnt_match_previous_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb, line 44</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_doesnt_match_previous_password?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-identifier">match</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_database_authentication_functions?</span>&#x000A;    <span class="ruby-identifier">salts</span> = <span class="ruby-identifier">previous_password_ds</span>.&#x000A;      <span class="ruby-identifier">select_map</span>([<span class="ruby-identifier">previous_password_id_column</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-value">:rodauth_get_previous_salt</span>), <span class="ruby-identifier">previous_password_id_column</span>).<span class="ruby-identifier">as</span>(<span class="ruby-value">:salt</span>)])&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">salts</span>.<span class="ruby-identifier">empty?</span>&#x000A;&#x000A;    <span class="ruby-identifier">salts</span>.<span class="ruby-identifier">any?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash_id</span>, <span class="ruby-identifier">salt</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">get</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-value">:rodauth_previous_password_hash_match</span>), <span class="ruby-identifier">hash_id</span>, <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">hash_secret</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>)))&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-identifier">previous_password_ds</span>.<span class="ruby-identifier">select_map</span>(<span class="ruby-identifier">previous_password_hash_column</span>).<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">hash</span><span class="ruby-operator">|</span> <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hash</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">password</span>}&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">match</span>&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_same_as_previous_password_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_expiration_ds'>
<a name='method-i-password_expiration_ds'></a>
<div class='synopsis'>
<span class='name'>password_expiration_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_expiration_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_expiration_ds-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 106</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_expiration_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">password_expiration_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">password_expiration_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_expired-3F'>
<a name='method-i-password_expired-3F'></a>
<div class='synopsis'>
<span class='name'>password_expired?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_expired-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_expired-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 67</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_expired?</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">password_changed_at_session_key</span>]&#x000A;    <span class="ruby-keyword">return</span> <span class="ruby-identifier">password_changed_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">require_password_change_after</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">account_from_session</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> = <span class="ruby-identifier">get_password_changed_at</span>&#x000A;    <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">password_changed_at_session_key</span>, <span class="ruby-identifier">password_changed_at</span>.<span class="ruby-identifier">to_i</span>)&#x000A;    <span class="ruby-identifier">password_changed_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">require_password_change_after</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">password_changed_at_session_key</span>, <span class="ruby-identifier">password_expiration_default</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">2147483647</span>)&#x000A;    <span class="ruby-identifier">password_expiration_default</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_has_enough_character_groups-3F'>
<a name='method-i-password_has_enough_character_groups-3F'></a>
<div class='synopsis'>
<span class='name'>password_has_enough_character_groups?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_has_enough_character_groups-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_has_enough_character_groups-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb, line 54</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_has_enough_character_groups?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">password_max_length_for_groups_check</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_character_groups</span>.<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">re</span><span class="ruby-operator">|</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">re</span>}.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">password_min_groups</span>&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_not_enough_character_groups_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_has_no_invalid_pattern-3F'>
<a name='method-i-password_has_no_invalid_pattern-3F'></a>
<div class='synopsis'>
<span class='name'>password_has_no_invalid_pattern?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_has_no_invalid_pattern-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_has_no_invalid_pattern-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb, line 61</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_has_no_invalid_pattern?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password_invalid_pattern</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">password_invalid_pattern</span>&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_invalid_pattern_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash'>
<a name='method-i-password_hash'></a>
<div class='synopsis'>
<span class='name'>password_hash</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 136</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">password</span>, <span class="ruby-value">:cost</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">password_hash_cost</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash_cost'>
<a name='method-i-password_hash_cost'></a>
<div class='synopsis'>
<span class='name'>password_hash_cost</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash_cost-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash_cost-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 125</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash_cost</span>&#x000A;  <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span><span class="ruby-operator">::</span><span class="ruby-constant">MIN_COST</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash_ds'>
<a name='method-i-password_hash_ds'></a>
<div class='synopsis'>
<span class='name'>password_hash_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash_ds-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 455</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">password_hash_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">password_hash_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_match-3F'>
<a name='method-i-password_match-3F'></a>
<div class='synopsis'>
<span class='name'>password_match?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_match-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 287</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_match?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">get_password_hash</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_password_hash_column</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">use_database_authentication_functions?</span>&#x000A;      <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hash</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">password</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">db</span>.<span class="ruby-identifier">get</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-value">:rodauth_valid_password_hash</span>), <span class="ruby-identifier">account_id</span>, <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">hash_secret</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">hash</span>)))&#x000A;    <span class="ruby-keyword">end</span> &#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_meets_length_requirements-3F'>
<a name='method-i-password_meets_length_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>password_meets_length_requirements?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_meets_length_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_meets_length_requirements-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 112</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_meets_length_requirements?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_minimum_length</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">length</span>&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_too_short_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_meets_requirements-3F'>
<a name='method-i-password_meets_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>password_meets_requirements?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_meets_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_meets_requirements-3F-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_common_passwords.rb, line 12</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_meets_requirements?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_not_one_of_the_most_common?</span>(<span class="ruby-identifier">password</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_not_in_dictionary-3F'>
<a name='method-i-password_not_in_dictionary-3F'></a>
<div class='synopsis'>
<span class='name'>password_not_in_dictionary?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_not_in_dictionary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_not_in_dictionary-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb, line 79</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_not_in_dictionary?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">dict</span> = <span class="ruby-identifier">password_dictionary</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\A(?:\d*)([A-Za-z!@$+|][A-Za-z!@$+|0134578]+[A-Za-z!@$+|])(?:\d*)\z/</span>&#x000A;  <span class="ruby-identifier">word</span> = <span class="ruby-node">$1</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-string">&#39;!@$+|0134578&#39;</span>, <span class="ruby-string">&#39;iastloleastb&#39;</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">dict</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">word</span>)&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_in_dictionary_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_not_one_of_the_most_common-3F'>
<a name='method-i-password_not_one_of_the_most_common-3F'></a>
<div class='synopsis'>
<span class='name'>password_not_one_of_the_most_common?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_not_one_of_the_most_common-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_not_one_of_the_most_common-3F-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_common_passwords.rb, line 32</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_not_one_of_the_most_common?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password_one_of_most_common?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_is_one_of_the_most_common_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_not_too_many_repeating_characters-3F'>
<a name='method-i-password_not_too_many_repeating_characters-3F'></a>
<div class='synopsis'>
<span class='name'>password_not_too_many_repeating_characters?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_not_too_many_repeating_characters-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_not_too_many_repeating_characters-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb, line 68</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_not_too_many_repeating_characters?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_max_repeating_characters</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/(.)(\1){#{password_max_repeating_characters-1}}/</span> &#x000A;  <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">password_too_many_repeating_characters_message</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_one_of_most_common-3F'>
<a name='method-i-password_one_of_most_common-3F'></a>
<div class='synopsis'>
<span class='name'>password_one_of_most_common?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_one_of_most_common-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_one_of_most_common-3F-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_common_passwords.rb, line 26</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_one_of_most_common?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-identifier">most_common_passwords</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">password</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_recently_entered-3F'>
<a name='method-i-password_recently_entered-3F'></a>
<div class='synopsis'>
<span class='name'>password_recently_entered?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_recently_entered-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_recently_entered-3F-source'><span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb, line 36</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_recently_entered?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">last_password_entry</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">last_password_entry_session_key</span>]&#x000A;  <span class="ruby-identifier">last_password_entry</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">password_grace_period</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_reset_ds'>
<a name='method-i-password_reset_ds'></a>
<div class='synopsis'>
<span class='name'>password_reset_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_reset_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_reset_ds-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 257</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_reset_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">reset_password_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">reset_password_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_too_many_repeating_characters_message'>
<a name='method-i-password_too_many_repeating_characters_message'></a>
<div class='synopsis'>
<span class='name'>password_too_many_repeating_characters_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_too_many_repeating_characters_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_too_many_repeating_characters_message-source'><span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb, line 75</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_too_many_repeating_characters_message</span>&#x000A;  <span class="ruby-node">&quot;contains #{password_max_repeating_characters} or more of the same character in a row&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_too_short_message'>
<a name='method-i-password_too_short_message'></a>
<div class='synopsis'>
<span class='name'>password_too_short_message</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_too_short_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_too_short_message-source'><span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb, line 75</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_too_short_message</span>&#x000A;  <span class="ruby-node">&quot;minimum #{password_minimum_length} characters&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-post_configure'>
<a name='method-i-post_configure'></a>
<div class='synopsis'>
<span class='name'>post_configure</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-post_configure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-post_configure-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 277</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">post_configure</span>&#x000A;  <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;bcrypt&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">require_bcrypt?</span>&#x000A;  <span class="ruby-identifier">db</span>.<span class="ruby-identifier">extension</span> <span class="ruby-value">:date_arithmetic</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_date_arithmetic?</span>&#x000A;  <span class="ruby-identifier">route_hash</span>= {}&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">routes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">route_hash</span>[<span class="ruby-node">&quot;/#{send(&quot;#{meth.to_s.sub(/\Ahandle_/, &#39;&#39;)}_route&quot;)}&quot;</span>] = <span class="ruby-identifier">meth</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">route_hash</span> = <span class="ruby-identifier">route_hash</span>.<span class="ruby-identifier">freeze</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-previous_password_ds'>
<a name='method-i-previous_password_ds'></a>
<div class='synopsis'>
<span class='name'>previous_password_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-previous_password_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-previous_password_ds-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb, line 76</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">previous_password_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">previous_password_hash_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">previous_password_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-raises_uniqueness_violation-3F'>
<a name='method-i-raises_uniqueness_violation-3F'></a>
<div class='synopsis'>
<span class='name'>raises_uniqueness_violation?</span>
<span class='arguments'>(&block)</span>

</div>
<div class='description'>

<p>In cases where retrying on uniqueness violations cannot work, this will
detect whether a uniqueness violation is raised by the block and return the
exception if so. This method should be used if you don&#39;t care about the
exception itself.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-raises_uniqueness_violation-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-raises_uniqueness_violation-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 484</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">raises_uniqueness_violation?</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">transaction</span>(<span class="ruby-value">:savepoint</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:only</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">rescue</span> <span class="ruby-identifier">unique_constraint_violation_class</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>&#x000A;  <span class="ruby-identifier">e</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-random_key'>
<a name='method-i-random_key'></a>
<div class='synopsis'>
<span class='name'>random_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-random_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-random_key-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 326</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">random_key</span>&#x000A;  <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">urlsafe_base64</span>(<span class="ruby-value">32</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_code_match-3F'>
<a name='method-i-recovery_code_match-3F'></a>
<div class='synopsis'>
<span class='name'>recovery_code_match?</span>
<span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_code_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_code_match-3F-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 186</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_code_match?</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-identifier">recovery_codes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">code</span>, <span class="ruby-identifier">s</span>)&#x000A;      <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">recovery_codes_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">code</span>).<span class="ruby-identifier">delete</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">recovery_codes_primary?</span>&#x000A;        <span class="ruby-identifier">add_recovery_code</span>&#x000A;      <span class="ruby-keyword">end</span>&#x000A;      <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_ds'>
<a name='method-i-recovery_codes_ds'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_ds-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 236</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">recovery_codes_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">recovery_codes_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_primary-3F'>
<a name='method-i-recovery_codes_primary-3F'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_primary?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_primary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_primary-3F-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 228</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_primary?</span>&#x000A;  (<span class="ruby-identifier">features</span> <span class="ruby-operator">&amp;</span> [<span class="ruby-value">:otp</span>, <span class="ruby-value">:sms_codes</span>]).<span class="ruby-identifier">empty?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_remove'>
<a name='method-i-recovery_codes_remove'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_remove</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_remove-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 182</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_remove</span>&#x000A;  <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-redirect'>
<a name='method-i-redirect'></a>
<div class='synopsis'>
<span class='name'>redirect</span>
<span class='arguments'>(path)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-redirect-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 317</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">redirect</span>(<span class="ruby-identifier">path</span>)&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">path</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remember_key_ds'>
<a name='method-i-remember_key_ds'></a>
<div class='synopsis'>
<span class='name'>remember_key_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remember_key_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remember_key_ds-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 193</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remember_key_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">remember_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">remember_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remember_login'>
<a name='method-i-remember_login'></a>
<div class='synopsis'>
<span class='name'>remember_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remember_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remember_login-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 116</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remember_login</span>&#x000A;  <span class="ruby-identifier">get_remember_key</span>&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">remember_cookie_options</span>]&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:value</span>] = <span class="ruby-node">&quot;#{account_id}_#{remember_key_value}&quot;</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:expires</span>] = <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_deadline_column</span>))&#x000A;  <span class="ruby-operator">::</span><span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">set_cookie_header!</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>, <span class="ruby-identifier">remember_cookie_key</span>, <span class="ruby-identifier">opts</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_email_auth_key'>
<a name='method-i-remove_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>remove_email_auth_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_email_auth_key-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 126</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_email_auth_key</span>&#x000A;  <span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_lockout_metadata'>
<a name='method-i-remove_lockout_metadata'></a>
<div class='synopsis'>
<span class='name'>remove_lockout_metadata</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_lockout_metadata-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_lockout_metadata-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 265</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_lockout_metadata</span>&#x000A;  <span class="ruby-identifier">account_login_failures_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;  <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_remember_key'>
<a name='method-i-remove_remember_key'></a>
<div class='synopsis'>
<span class='name'>remove_remember_key</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_remember_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_remember_key-source'><span class="ruby-comment"># File lib/rodauth/features/remember.rb, line 154</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_remember_key</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_reset_password_key'>
<a name='method-i-remove_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>remove_reset_password_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_reset_password_key-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 169</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_reset_password_key</span>&#x000A;  <span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_verify_account_key'>
<a name='method-i-remove_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>remove_verify_account_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_verify_account_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 159</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_verify_account_key</span>&#x000A;  <span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_verify_login_change_key'>
<a name='method-i-remove_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>remove_verify_login_change_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_verify_login_change_key-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 101</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_verify_login_change_key</span>&#x000A;  <span class="ruby-identifier">verify_login_change_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-render'>
<a name='method-i-render'></a>
<div class='synopsis'>
<span class='name'>render</span>
<span class='arguments'>(page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-render-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-render-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 269</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">render</span>(<span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-identifier">_view</span>(<span class="ruby-value">:render</span>, <span class="ruby-identifier">page</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-request'>
<a name='method-i-request'></a>
<div class='synopsis'>
<span class='name'>request</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-request-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 113</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">request</span>&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">request</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_account'>
<a name='method-i-require_account'></a>
<div class='synopsis'>
<span class='name'>require_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_account-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 346</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_account</span>&#x000A;  <span class="ruby-identifier">require_authentication</span>&#x000A;  <span class="ruby-identifier">require_account_session</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_account_session'>
<a name='method-i-require_account_session'></a>
<div class='synopsis'>
<span class='name'>require_account_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_account_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_account_session-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 351</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_account_session</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_from_session</span>&#x000A;    <span class="ruby-identifier">clear_session</span>&#x000A;    <span class="ruby-identifier">login_required</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_authentication'>
<a name='method-i-require_authentication'></a>
<div class='synopsis'>
<span class='name'>require_authentication</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_authentication-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_authentication-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 227</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_authentication</span>&#x000A;  <span class="ruby-identifier">require_login</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_current_password'>
<a name='method-i-require_current_password'></a>
<div class='synopsis'>
<span class='name'>require_current_password</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_current_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_current_password-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 60</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_current_password</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">authenticated?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_expired?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_change_needed_redirect</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path_info</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">password_expiration_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">password_change_needed_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_login'>
<a name='method-i-require_login'></a>
<div class='synopsis'>
<span class='name'>require_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_login-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 219</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_login</span>&#x000A;  <span class="ruby-identifier">login_required</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_otp_setup'>
<a name='method-i-require_otp_setup'></a>
<div class='synopsis'>
<span class='name'>require_otp_setup</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_otp_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_otp_setup-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 240</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_otp_setup</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">otp_exists?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_not_setup_error_status</span>)&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_not_setup_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_need_setup_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_sms_available'>
<a name='method-i-require_sms_available'></a>
<div class='synopsis'>
<span class='name'>require_sms_available</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_sms_available-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_sms_available-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 355</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_sms_available</span>&#x000A;  <span class="ruby-identifier">require_sms_setup</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sms_locked_out?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">lockout_error_status</span>)&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">sms_lockout_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_lockout_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_sms_not_setup'>
<a name='method-i-require_sms_not_setup'></a>
<div class='synopsis'>
<span class='name'>require_sms_not_setup</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_sms_not_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_sms_not_setup-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 347</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_sms_not_setup</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sms_setup?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">sms_already_setup_error_status</span>)&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">sms_already_setup_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_already_setup_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_sms_setup'>
<a name='method-i-require_sms_setup'></a>
<div class='synopsis'>
<span class='name'>require_sms_setup</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_sms_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_sms_setup-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 339</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_sms_setup</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sms_setup?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_not_setup_error_status</span>)&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">sms_not_setup_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_needs_setup_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_two_factor_authenticated'>
<a name='method-i-require_two_factor_authenticated'></a>
<div class='synopsis'>
<span class='name'>require_two_factor_authenticated</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_two_factor_authenticated-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_two_factor_authenticated-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 77</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_two_factor_authenticated</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">two_factor_authenticated?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_need_authentication_error_status</span>)&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_need_authentication_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">_two_factor_auth_required_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_two_factor_not_authenticated'>
<a name='method-i-require_two_factor_not_authenticated'></a>
<div class='synopsis'>
<span class='name'>require_two_factor_not_authenticated</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_two_factor_not_authenticated-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_two_factor_not_authenticated-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 69</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_two_factor_not_authenticated</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_authenticated?</span>&#x000A;    <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_already_authenticated_error_status</span>)&#x000A;    <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_already_authenticated_error_flash</span>&#x000A;    <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_already_authenticated_redirect</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_two_factor_setup'>
<a name='method-i-require_two_factor_setup'></a>
<div class='synopsis'>
<span class='name'>require_two_factor_setup</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_two_factor_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_two_factor_setup-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 58</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_two_factor_setup</span>&#x000A;  <span class="ruby-comment"># Avoid database query if already authenticated via 2nd factor</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_authenticated?</span>&#x000A;&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uses_two_factor_authentication?</span>&#x000A;&#x000A;  <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_not_setup_error_status</span>)&#x000A;  <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_not_setup_error_flash</span>&#x000A;  <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_need_setup_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_email_body'>
<a name='method-i-reset_password_email_body'></a>
<div class='synopsis'>
<span class='name'>reset_password_email_body</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_email_body-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 243</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_email_body</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;reset-password-email&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_email_link'>
<a name='method-i-reset_password_email_link'></a>
<div class='synopsis'>
<span class='name'>reset_password_email_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_email_link-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 181</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_email_link</span>&#x000A;  <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">reset_password_route</span>, <span class="ruby-identifier">reset_password_key_param</span>, <span class="ruby-identifier">reset_password_key_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_email_recently_sent-3F'>
<a name='method-i-reset_password_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>reset_password_email_recently_sent?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_email_recently_sent-3F-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 213</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_email_recently_sent?</span>&#x000A;  (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_reset_password_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">reset_password_skip_resend_email_within</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_key_insert_hash'>
<a name='method-i-reset_password_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>reset_password_key_insert_hash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_key_insert_hash-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 251</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_key_insert_hash</span>&#x000A;  <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">reset_password_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">reset_password_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">reset_password_key_value</span>}&#x000A;  <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">reset_password_deadline_column</span>, <span class="ruby-identifier">reset_password_deadline_interval</span>)&#x000A;  <span class="ruby-identifier">hash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_request_link'>
<a name='method-i-reset_password_request_link'></a>
<div class='synopsis'>
<span class='name'>reset_password_request_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_request_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_request_link-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 195</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_request_link</span>&#x000A;  <span class="ruby-node">&quot;&lt;p&gt;&lt;a href=\&quot;#{prefix}/#{reset_password_request_route}\&quot;&gt;Forgot Password?&lt;/a&gt;&lt;/p&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_single_session_key'>
<a name='method-i-reset_single_session_key'></a>
<div class='synopsis'>
<span class='name'>reset_single_session_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_single_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_single_session_key-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 19</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_single_session_key</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span>&#x000A;    <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">single_session_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">random_key</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-response'>
<a name='method-i-response'></a>
<div class='synopsis'>
<span class='name'>response</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-response-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 117</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">response</span>&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">response</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-retry_on_uniqueness_violation'>
<a name='method-i-retry_on_uniqueness_violation'></a>
<div class='synopsis'>
<span class='name'>retry_on_uniqueness_violation</span>
<span class='arguments'>(&block)</span>

</div>
<div class='description'>

<p>This is used to avoid race conditions when using the pattern of inserting
when an update affects no rows.  In such cases, if a row is inserted
between the update and the insert, the insert will fail with a uniqueness
error, but retrying will work.  It is possible for it to fail again, but
only if the row is deleted before the update and readded before the insert,
which is very unlikely to happen.  In such cases, raising an exception is
acceptable.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-retry_on_uniqueness_violation-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-retry_on_uniqueness_violation-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 475</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">retry_on_uniqueness_violation</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">raises_uniqueness_violation?</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;    <span class="ruby-keyword">yield</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-return_json_response'>
<a name='method-i-return_json_response'></a>
<div class='synopsis'>
<span class='name'>return_json_response</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-return_json_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-return_json_response-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 211</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">return_json_response</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">json_response_error_status</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_error_key</span>]&#x000A;  <span class="ruby-identifier">set_jwt</span>&#x000A;  <span class="ruby-identifier">response</span>[<span class="ruby-string">&#39;Content-Type&#39;</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">json_response_content_type</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">_json_response_body</span>(<span class="ruby-identifier">json_response</span>))&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">halt</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-route-21'>
<a name='method-i-route-21'></a>
<div class='synopsis'>
<span class='name'>route!</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-route-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-route-21-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 129</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">route!</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">meth</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">route_hash</span>[<span class="ruby-identifier">request</span>.<span class="ruby-identifier">remaining_path</span>]&#x000A;    <span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-save_account'>
<a name='method-i-save_account'></a>
<div class='synopsis'>
<span class='name'>save_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-save_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-save_account-source'><span class="ruby-comment"># File lib/rodauth/features/create_account.rb, line 106</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">save_account</span>&#x000A;  <span class="ruby-identifier">id</span> = <span class="ruby-keyword">nil</span>&#x000A;  <span class="ruby-identifier">raised</span> = <span class="ruby-identifier">raises_uniqueness_violation?</span>{<span class="ruby-identifier">id</span> = <span class="ruby-identifier">db</span>[<span class="ruby-identifier">accounts_table</span>].<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">account</span>)}&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">raised</span>&#x000A;    <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-string">&#39;already an account with this login&#39;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>&#x000A;    <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_id_column</span>] = <span class="ruby-identifier">id</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">raised</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_email_auth_email'>
<a name='method-i-send_email_auth_email'></a>
<div class='synopsis'>
<span class='name'>send_email_auth_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_email_auth_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_email_auth_email-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 134</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_email_auth_email</span>&#x000A;  <span class="ruby-identifier">create_email_auth_email</span>.<span class="ruby-identifier">deliver!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_password_changed_email'>
<a name='method-i-send_password_changed_email'></a>
<div class='synopsis'>
<span class='name'>send_password_changed_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_password_changed_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_password_changed_email-source'><span class="ruby-comment"># File lib/rodauth/features/change_password_notify.rb, line 18</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_password_changed_email</span>&#x000A;  <span class="ruby-identifier">create_password_changed_email</span>.<span class="ruby-identifier">deliver!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_reset_password_email'>
<a name='method-i-send_reset_password_email'></a>
<div class='synopsis'>
<span class='name'>send_reset_password_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_reset_password_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_reset_password_email-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 177</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_reset_password_email</span>&#x000A;  <span class="ruby-identifier">create_reset_password_email</span>.<span class="ruby-identifier">deliver!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_unlock_account_email'>
<a name='method-i-send_unlock_account_email'></a>
<div class='synopsis'>
<span class='name'>send_unlock_account_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_unlock_account_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_unlock_account_email-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 214</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_unlock_account_email</span>&#x000A;  <span class="ruby-ivar">@unlock_account_key_value</span> = <span class="ruby-identifier">get_unlock_account_key</span>&#x000A;  <span class="ruby-identifier">create_unlock_account_email</span>.<span class="ruby-identifier">deliver!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_verify_account_email'>
<a name='method-i-send_verify_account_email'></a>
<div class='synopsis'>
<span class='name'>send_verify_account_email</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_verify_account_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_verify_account_email-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 197</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_verify_account_email</span>&#x000A;  <span class="ruby-identifier">create_verify_account_email</span>.<span class="ruby-identifier">deliver!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_verify_login_change_email'>
<a name='method-i-send_verify_login_change_email'></a>
<div class='synopsis'>
<span class='name'>send_verify_login_change_email</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_verify_login_change_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_verify_login_change_email-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 117</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_verify_login_change_email</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">create_verify_login_change_email</span>(<span class="ruby-identifier">login</span>).<span class="ruby-identifier">deliver!</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session'>
<a name='method-i-session'></a>
<div class='synopsis'>
<span class='name'>session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 121</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session</span>&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">session</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_expiration_redirect'>
<a name='method-i-session_expiration_redirect'></a>
<div class='synopsis'>
<span class='name'>session_expiration_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_expiration_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_expiration_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/session_expiration.rb, line 43</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_expiration_redirect</span>&#x000A;  <span class="ruby-identifier">require_login_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_jwt'>
<a name='method-i-session_jwt'></a>
<div class='synopsis'>
<span class='name'>session_jwt</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_jwt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_jwt-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 116</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_jwt</span>&#x000A;  <span class="ruby-constant">JWT</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">jwt_session_hash</span>, <span class="ruby-identifier">jwt_secret</span>, <span class="ruby-identifier">jwt_algorithm</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_value'>
<a name='method-i-session_value'></a>
<div class='synopsis'>
<span class='name'>session_value</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_value-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 151</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_value</span>&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_key</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_deadline_value'>
<a name='method-i-set_deadline_value'></a>
<div class='synopsis'>
<span class='name'>set_deadline_value</span>
<span class='arguments'>(hash, column, interval)</span>

</div>
<div class='description'>

<p>This is needed on MySQL, which doesn&#39;t support non constant defaults
other than CURRENT_TIMESTAMP.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_deadline_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_deadline_value-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 511</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">column</span>, <span class="ruby-identifier">interval</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">set_deadline_values?</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">column</span>] = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-identifier">interval</span>)&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_deadline_values-3F'>
<a name='method-i-set_deadline_values-3F'></a>
<div class='synopsis'>
<span class='name'>set_deadline_values?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_deadline_values-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_deadline_values-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 384</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_deadline_values?</span>&#x000A;  <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:mysql</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_email_auth_email_last_sent'>
<a name='method-i-set_email_auth_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_email_auth_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_email_auth_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_email_auth_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 114</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_email_auth_email_last_sent</span>&#x000A;   <span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">email_auth_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">email_auth_email_last_sent_column</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_error_flash'>
<a name='method-i-set_error_flash'></a>
<div class='synopsis'>
<span class='name'>set_error_flash</span>
<span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_error_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_error_flash-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 203</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_error_flash</span>(<span class="ruby-identifier">message</span>)&#x000A;  <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">flash_error_key</span>] = <span class="ruby-identifier">message</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_expired'>
<a name='method-i-set_expired'></a>
<div class='synopsis'>
<span class='name'>set_expired</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_expired-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_expired-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 48</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_expired</span>&#x000A;  <span class="ruby-identifier">update_activity</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_activity_expired_column</span>)&#x000A;  <span class="ruby-identifier">after_account_expiration</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_field_error'>
<a name='method-i-set_field_error'></a>
<div class='synopsis'>
<span class='name'>set_field_error</span>
<span class='arguments'>(field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_field_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_field_error-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 137</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_field_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)&#x000A;  (<span class="ruby-ivar">@field_errors</span> <span class="ruby-operator">||=</span> {})[<span class="ruby-identifier">field</span>] = <span class="ruby-identifier">error</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_http_basic_auth_error_response'>
<a name='method-i-set_http_basic_auth_error_response'></a>
<div class='synopsis'>
<span class='name'>set_http_basic_auth_error_response</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_http_basic_auth_error_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_http_basic_auth_error_response-source'><span class="ruby-comment"># File lib/rodauth/features/http_basic_auth.rb, line 53</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_http_basic_auth_error_response</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">401</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&quot;WWW-Authenticate&quot;</span>] = <span class="ruby-node">&quot;Basic realm=\&quot;#{http_basic_auth_realm}\&quot;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_jwt'>
<a name='method-i-set_jwt'></a>
<div class='synopsis'>
<span class='name'>set_jwt</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_jwt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_jwt-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 219</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_jwt</span>&#x000A;  <span class="ruby-identifier">set_jwt_token</span>(<span class="ruby-identifier">session_jwt</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_jwt_token'>
<a name='method-i-set_jwt_token'></a>
<div class='synopsis'>
<span class='name'>set_jwt_token</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_jwt_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_jwt_token-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 128</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_jwt_token</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;Authorization&#39;</span>] = <span class="ruby-identifier">token</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_last_password_entry'>
<a name='method-i-set_last_password_entry'></a>
<div class='synopsis'>
<span class='name'>set_last_password_entry</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_last_password_entry-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_last_password_entry-source'><span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb, line 41</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_last_password_entry</span>&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">last_password_entry_session_key</span>] = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_new_account_password'>
<a name='method-i-set_new_account_password'></a>
<div class='synopsis'>
<span class='name'>set_new_account_password</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_new_account_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_new_account_password-source'><span class="ruby-comment"># File lib/rodauth/features/create_account.rb, line 98</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_new_account_password</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_password_hash_column</span>] = <span class="ruby-identifier">password_hash</span>(<span class="ruby-identifier">password</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_notice_flash'>
<a name='method-i-set_notice_flash'></a>
<div class='synopsis'>
<span class='name'>set_notice_flash</span>
<span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_notice_flash-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 211</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_notice_flash</span>(<span class="ruby-identifier">message</span>)&#x000A;  <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">flash_notice_key</span>] = <span class="ruby-identifier">message</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_notice_now_flash'>
<a name='method-i-set_notice_now_flash'></a>
<div class='synopsis'>
<span class='name'>set_notice_now_flash</span>
<span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_notice_now_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_notice_now_flash-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 215</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_notice_now_flash</span>(<span class="ruby-identifier">message</span>)&#x000A;  <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">flash_notice_key</span>] = <span class="ruby-identifier">message</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_password'>
<a name='method-i-set_password'></a>
<div class='synopsis'>
<span class='name'>set_password</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_password-source'><span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb, line 18</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_password</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-identifier">hash</span> = <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-identifier">add_previous_password_hash</span>(<span class="ruby-identifier">hash</span>)&#x000A;  <span class="ruby-identifier">hash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_redirect_error_flash'>
<a name='method-i-set_redirect_error_flash'></a>
<div class='synopsis'>
<span class='name'>set_redirect_error_flash</span>
<span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_redirect_error_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_redirect_error_flash-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 207</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_redirect_error_flash</span>(<span class="ruby-identifier">message</span>)&#x000A;  <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">flash_error_key</span>] = <span class="ruby-identifier">message</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_redirect_error_status'>
<a name='method-i-set_redirect_error_status'></a>
<div class='synopsis'>
<span class='name'>set_redirect_error_status</span>
<span class='arguments'>(status)</span>

</div>
<div class='description'>

<p>Don&#39;t set an error status when redirecting in an error case, as a
redirect status is needed.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_redirect_error_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_redirect_error_status-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 363</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_redirect_error_status</span>(<span class="ruby-identifier">status</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_reset_password_email_last_sent'>
<a name='method-i-set_reset_password_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_reset_password_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_reset_password_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_reset_password_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/reset_password.rb, line 199</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_reset_password_email_last_sent</span>&#x000A;   <span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">reset_password_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">reset_password_email_last_sent_column</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_response_error_status'>
<a name='method-i-set_response_error_status'></a>
<div class='synopsis'>
<span class='name'>set_response_error_status</span>
<span class='arguments'>(status)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_response_error_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_response_error_status-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 366</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_response_error_status</span>(<span class="ruby-identifier">status</span>)&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-identifier">status</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_session_value'>
<a name='method-i-set_session_value'></a>
<div class='synopsis'>
<span class='name'>set_session_value</span>
<span class='arguments'>(key, value)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_session_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_session_value-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 519</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_session_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_title'>
<a name='method-i-set_title'></a>
<div class='synopsis'>
<span class='name'>set_title</span>
<span class='arguments'>(title)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_title-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_title-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 197</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_title</span>(<span class="ruby-identifier">title</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">title_instance_variable</span>&#x000A;    <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">title_instance_variable</span>, <span class="ruby-identifier">title</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_unlock_account_email_last_sent'>
<a name='method-i-set_unlock_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_unlock_account_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_unlock_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_unlock_account_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 231</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_unlock_account_email_last_sent</span>&#x000A;  <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">account_lockouts_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_lockouts_email_last_sent_column</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_verify_account_email_last_sent'>
<a name='method-i-set_verify_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_verify_account_email_last_sent</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_verify_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_verify_account_email_last_sent-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 230</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_verify_account_email_last_sent</span>&#x000A;   <span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">verify_account_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">verify_account_email_last_sent_column</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-setup_account_verification'>
<a name='method-i-setup_account_verification'></a>
<div class='synopsis'>
<span class='name'>setup_account_verification</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-setup_account_verification-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-setup_account_verification-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 265</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">setup_account_verification</span>&#x000A;  <span class="ruby-identifier">generate_verify_account_key_value</span>&#x000A;  <span class="ruby-identifier">create_verify_account_key</span>&#x000A;  <span class="ruby-identifier">send_verify_account_email</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-show_lockout_page'>
<a name='method-i-show_lockout_page'></a>
<div class='synopsis'>
<span class='name'>show_lockout_page</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-show_lockout_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-show_lockout_page-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 270</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">show_lockout_page</span>&#x000A;  <span class="ruby-identifier">set_response_error_status</span> <span class="ruby-identifier">lockout_error_status</span>&#x000A;  <span class="ruby-identifier">set_error_flash</span> <span class="ruby-identifier">login_lockout_error_flash</span>&#x000A;  <span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">unlock_account_request_view</span>&#x000A;  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">halt</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-single_session_ds'>
<a name='method-i-single_session_ds'></a>
<div class='synopsis'>
<span class='name'>single_session_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-single_session_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-single_session_ds-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 81</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">single_session_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">single_session_table</span>].&#x000A;    <span class="ruby-identifier">where</span>(<span class="ruby-identifier">single_session_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-skip_login_field_on_login-3F'>
<a name='method-i-skip_login_field_on_login-3F'></a>
<div class='synopsis'>
<span class='name'>skip_login_field_on_login?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_login_field_on_login-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_login_field_on_login-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login.rb, line 69</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_login_field_on_login?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_multi_phase_login?</span>&#x000A;  <span class="ruby-ivar">@valid_login_entered</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-skip_password_field_on_login-3F'>
<a name='method-i-skip_password_field_on_login-3F'></a>
<div class='synopsis'>
<span class='name'>skip_password_field_on_login?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_password_field_on_login-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_password_field_on_login-3F-source'><span class="ruby-comment"># File lib/rodauth/features/login.rb, line 74</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_password_field_on_login?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_multi_phase_login?</span>&#x000A;  <span class="ruby-ivar">@valid_login_entered</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-skip_status_checks-3F'>
<a name='method-i-skip_status_checks-3F'></a>
<div class='synopsis'>
<span class='name'>skip_status_checks?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_status_checks-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_status_checks-3F-source'><span class="ruby-comment"># File lib/rodauth/features/close_account.rb, line 79</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_status_checks?</span>&#x000A;  <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_auth_message'>
<a name='method-i-sms_auth_message'></a>
<div class='synopsis'>
<span class='name'>sms_auth_message</span>
<span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_auth_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_auth_message-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 416</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_auth_message</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-node">&quot;SMS authentication code for #{request.host} is #{code}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_available-3F'>
<a name='method-i-sms_available-3F'></a>
<div class='synopsis'>
<span class='name'>sms_available?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_available-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_available-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 458</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_available?</span>&#x000A;  <span class="ruby-identifier">sms</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sms_needs_confirmation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sms_locked_out?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_code'>
<a name='method-i-sms_code'></a>
<div class='synopsis'>
<span class='name'>sms_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_code-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 437</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_code</span>&#x000A;  <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_code_column</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_code_issued_at'>
<a name='method-i-sms_code_issued_at'></a>
<div class='synopsis'>
<span class='name'>sms_code_issued_at</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_code_issued_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_code_issued_at-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 441</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_code_issued_at</span>&#x000A;  <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_issued_at_column</span>])&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_code_match-3F'>
<a name='method-i-sms_code_match-3F'></a>
<div class='synopsis'>
<span class='name'>sms_code_match?</span>
<span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_code_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_code_match-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 365</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_code_match?</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sms_current_auth?</span>&#x000A;  <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">code</span>, <span class="ruby-identifier">sms_code</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_codes_primary-3F'>
<a name='method-i-sms_codes_primary-3F'></a>
<div class='synopsis'>
<span class='name'>sms_codes_primary?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_codes_primary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_codes_primary-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 472</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_codes_primary?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-identifier">features</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:otp</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirm'>
<a name='method-i-sms_confirm'></a>
<div class='synopsis'>
<span class='name'>sms_confirm</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirm-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirm-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 163</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirm</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;  <span class="ruby-identifier">add_recovery_codes</span>(<span class="ruby-identifier">recovery_codes_limit</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">recovery_codes</span>.<span class="ruby-identifier">length</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirm_failure'>
<a name='method-i-sms_confirm_failure'></a>
<div class='synopsis'>
<span class='name'>sms_confirm_failure</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirm_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirm_failure-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 380</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirm_failure</span>&#x000A;  <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">delete</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirm_message'>
<a name='method-i-sms_confirm_message'></a>
<div class='synopsis'>
<span class='name'>sms_confirm_message</span>
<span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirm_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirm_message-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 420</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirm_message</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-node">&quot;SMS confirmation code for #{request.host} is #{code}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirmation_match-3F'>
<a name='method-i-sms_confirmation_match-3F'></a>
<div class='synopsis'>
<span class='name'>sms_confirmation_match?</span>
<span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirmation_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirmation_match-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 370</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirmation_match?</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-identifier">sms_needs_confirmation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sms_code_match?</span>(<span class="ruby-identifier">code</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_current_auth-3F'>
<a name='method-i-sms_current_auth-3F'></a>
<div class='synopsis'>
<span class='name'>sms_current_auth?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_current_auth-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_current_auth-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 466</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_current_auth?</span>&#x000A;  <span class="ruby-identifier">sms_code</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sms_code_issued_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sms_code_allowed_seconds</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_disable'>
<a name='method-i-sms_disable'></a>
<div class='synopsis'>
<span class='name'>sms_disable</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_disable-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_disable-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 175</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_disable</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">recovery_codes_primary?</span>&#x000A;    <span class="ruby-identifier">recovery_codes_remove</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_ds'>
<a name='method-i-sms_ds'></a>
<div class='synopsis'>
<span class='name'>sms_ds</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_ds-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 500</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_ds</span>&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">sms_codes_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">sms_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_failures'>
<a name='method-i-sms_failures'></a>
<div class='synopsis'>
<span class='name'>sms_failures</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_failures-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 445</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_failures</span>&#x000A;  <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_failures_column</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_locked_out-3F'>
<a name='method-i-sms_locked_out-3F'></a>
<div class='synopsis'>
<span class='name'>sms_locked_out?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_locked_out-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_locked_out-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 462</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_locked_out?</span>&#x000A;  <span class="ruby-identifier">sms_failures</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">sms_failure_limit</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_needs_confirmation-3F'>
<a name='method-i-sms_needs_confirmation-3F'></a>
<div class='synopsis'>
<span class='name'>sms_needs_confirmation?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_needs_confirmation-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_needs_confirmation-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 454</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_needs_confirmation?</span>&#x000A;  <span class="ruby-identifier">sms</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sms_failures</span>.<span class="ruby-identifier">nil?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_new_auth_code'>
<a name='method-i-sms_new_auth_code'></a>
<div class='synopsis'>
<span class='name'>sms_new_auth_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_new_auth_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_new_auth_code-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 480</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_new_auth_code</span>&#x000A;  <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">random_number</span>(<span class="ruby-value">10</span><span class="ruby-operator">**</span><span class="ruby-identifier">sms_auth_code_length</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-identifier">sms_auth_code_length</span>, <span class="ruby-string">&quot;0&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_new_confirm_code'>
<a name='method-i-sms_new_confirm_code'></a>
<div class='synopsis'>
<span class='name'>sms_new_confirm_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_new_confirm_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_new_confirm_code-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 484</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_new_confirm_code</span>&#x000A;  <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">random_number</span>(<span class="ruby-value">10</span><span class="ruby-operator">**</span><span class="ruby-identifier">sms_confirm_code_length</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-identifier">sms_confirm_code_length</span>, <span class="ruby-string">&quot;0&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_normalize_phone'>
<a name='method-i-sms_normalize_phone'></a>
<div class='synopsis'>
<span class='name'>sms_normalize_phone</span>
<span class='arguments'>(phone)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_normalize_phone-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_normalize_phone-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 476</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_normalize_phone</span>(<span class="ruby-identifier">phone</span>)&#x000A;  <span class="ruby-identifier">phone</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\D+/</span>, <span class="ruby-string">&#39;&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_phone'>
<a name='method-i-sms_phone'></a>
<div class='synopsis'>
<span class='name'>sms_phone</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_phone-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_phone-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 433</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_phone</span>&#x000A;  <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_phone_column</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_record_failure'>
<a name='method-i-sms_record_failure'></a>
<div class='synopsis'>
<span class='name'>sms_record_failure</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_record_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_record_failure-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 428</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_record_failure</span>&#x000A;  <span class="ruby-identifier">update_sms</span>(<span class="ruby-identifier">sms_failures_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">sms_failures_column</span>)<span class="ruby-value">+1</span>)&#x000A;  <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_failures_column</span>] = <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">sms_failures_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_remove_failures'>
<a name='method-i-sms_remove_failures'></a>
<div class='synopsis'>
<span class='name'>sms_remove_failures</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_remove_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_remove_failures-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 391</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_remove_failures</span>&#x000A;  <span class="ruby-identifier">update_sms</span>(<span class="ruby-identifier">sms_failures_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">sms_code_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">nil</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_send'>
<a name='method-i-sms_send'></a>
<div class='synopsis'>
<span class='name'>sms_send</span>
<span class='arguments'>(phone, message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_send-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_send-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 488</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_send</span>(<span class="ruby-identifier">phone</span>, <span class="ruby-identifier">message</span>)&#x000A;  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;sms_send needs to be defined in the Rodauth configuration for SMS sending to work&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_send_auth_code'>
<a name='method-i-sms_send_auth_code'></a>
<div class='synopsis'>
<span class='name'>sms_send_auth_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_send_auth_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_send_auth_code-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 400</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_send_auth_code</span>&#x000A;  <span class="ruby-identifier">code</span> = <span class="ruby-identifier">sms_new_auth_code</span>&#x000A;  <span class="ruby-identifier">sms_set_code</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-identifier">sms_send</span>(<span class="ruby-identifier">sms_phone</span>, <span class="ruby-identifier">sms_auth_message</span>(<span class="ruby-identifier">code</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_send_confirm_code'>
<a name='method-i-sms_send_confirm_code'></a>
<div class='synopsis'>
<span class='name'>sms_send_confirm_code</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_send_confirm_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_send_confirm_code-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 406</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_send_confirm_code</span>&#x000A;  <span class="ruby-identifier">code</span> = <span class="ruby-identifier">sms_new_confirm_code</span>&#x000A;  <span class="ruby-identifier">sms_set_code</span>(<span class="ruby-identifier">code</span>)&#x000A;  <span class="ruby-identifier">sms_send</span>(<span class="ruby-identifier">sms_phone</span>, <span class="ruby-identifier">sms_confirm_message</span>(<span class="ruby-identifier">code</span>))&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_set_code'>
<a name='method-i-sms_set_code'></a>
<div class='synopsis'>
<span class='name'>sms_set_code</span>
<span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_set_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_set_code-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 424</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_set_code</span>(<span class="ruby-identifier">code</span>)&#x000A; <span class="ruby-identifier">update_sms</span>(<span class="ruby-identifier">sms_code_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">code</span>, <span class="ruby-identifier">sms_issued_at_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_setup'>
<a name='method-i-sms_setup'></a>
<div class='synopsis'>
<span class='name'>sms_setup</span>
<span class='arguments'>(phone_number)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_setup-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 384</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_setup</span>(<span class="ruby-identifier">phone_number</span>)&#x000A;  <span class="ruby-comment"># Cannot handle uniqueness violation here, as the phone number given may not match the</span>&#x000A;  <span class="ruby-comment"># one in the table.</span>&#x000A;  <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">sms_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">sms_phone_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">phone_number</span>)&#x000A;  <span class="ruby-identifier">remove_instance_variable</span>(<span class="ruby-value">:@sms</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@sms</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_setup-3F'>
<a name='method-i-sms_setup-3F'></a>
<div class='synopsis'>
<span class='name'>sms_setup?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_setup-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_setup-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 449</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_setup?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sms</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-identifier">sms_needs_confirmation?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_valid_phone-3F'>
<a name='method-i-sms_valid_phone-3F'></a>
<div class='synopsis'>
<span class='name'>sms_valid_phone?</span>
<span class='arguments'>(phone)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_valid_phone-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_valid_phone-3F-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 412</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_valid_phone?</span>(<span class="ruby-identifier">phone</span>)&#x000A;  <span class="ruby-identifier">phone</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">sms_phone_min_length</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-split_token'>
<a name='method-i-split_token'></a>
<div class='synopsis'>
<span class='name'>split_token</span>
<span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-split_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-split_token-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 47</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_token</span>(<span class="ruby-identifier">token</span>)&#x000A;  <span class="ruby-identifier">token</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">token_separator</span>, <span class="ruby-value">2</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-template_path'>
<a name='method-i-template_path'></a>
<div class='synopsis'>
<span class='name'>template_path</span>
<span class='arguments'>(page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-template_path-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-template_path-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 444</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">template_path</span>(<span class="ruby-identifier">page</span>)&#x000A;  <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword">__FILE__</span>), <span class="ruby-string">&#39;../../../templates&#39;</span>, <span class="ruby-node">&quot;#{page}.str&quot;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_basic_auth_error'>
<a name='method-i-throw_basic_auth_error'></a>
<div class='synopsis'>
<span class='name'>throw_basic_auth_error</span>
<span class='arguments'>(*args)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_basic_auth_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_basic_auth_error-source'><span class="ruby-comment"># File lib/rodauth/features/http_basic_auth.rb, line 58</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_basic_auth_error</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">set_http_basic_auth_error_response</span>&#x000A;  <span class="ruby-identifier">throw_error</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) &#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_error'>
<a name='method-i-throw_error'></a>
<div class='synopsis'>
<span class='name'>throw_error</span>
<span class='arguments'>(field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_error-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 370</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)&#x000A;  <span class="ruby-identifier">set_field_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)&#x000A;  <span class="ruby-identifier">throw</span> <span class="ruby-value">:rodauth_error</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_error_status'>
<a name='method-i-throw_error_status'></a>
<div class='synopsis'>
<span class='name'>throw_error_status</span>
<span class='arguments'>(status, field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_error_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_error_status-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 375</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_error_status</span>(<span class="ruby-identifier">status</span>, <span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)&#x000A;  <span class="ruby-identifier">set_response_error_status</span>(<span class="ruby-identifier">status</span>)&#x000A;  <span class="ruby-identifier">throw_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-timing_safe_eql-3F'>
<a name='method-i-timing_safe_eql-3F'></a>
<div class='synopsis'>
<span class='name'>timing_safe_eql?</span>
<span class='arguments'>(provided, actual)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-timing_safe_eql-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-timing_safe_eql-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 341</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">timing_safe_eql?</span>(<span class="ruby-identifier">provided</span>, <span class="ruby-identifier">actual</span>)&#x000A;  <span class="ruby-identifier">provided</span> = <span class="ruby-identifier">provided</span>.<span class="ruby-identifier">to_s</span>&#x000A;  <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">secure_compare</span>(<span class="ruby-identifier">provided</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-identifier">actual</span>.<span class="ruby-identifier">length</span>), <span class="ruby-identifier">actual</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">provided</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">actual</span>.<span class="ruby-identifier">length</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-token_link'>
<a name='method-i-token_link'></a>
<div class='synopsis'>
<span class='name'>token_link</span>
<span class='arguments'>(route, param, key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-token_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-token_link-source'><span class="ruby-comment"># File lib/rodauth/features/email_base.rb, line 51</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">token_link</span>(<span class="ruby-identifier">route</span>, <span class="ruby-identifier">param</span>, <span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-node">&quot;#{request.base_url}#{prefix}/#{route}?#{param}=#{account_id}#{token_separator}#{key}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-transaction'>
<a name='method-i-transaction'></a>
<div class='synopsis'>
<span class='name'>transaction</span>
<span class='arguments'>(opts={}, &block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-transaction-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-transaction-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 321</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">transaction</span>(<span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_auth_fallback_redirect'>
<a name='method-i-two_factor_auth_fallback_redirect'></a>
<div class='synopsis'>
<span class='name'>two_factor_auth_fallback_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_auth_fallback_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_auth_fallback_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb, line 133</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_auth_fallback_redirect</span>&#x000A;  <span class="ruby-identifier">recovery_auth_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_auth_required_redirect'>
<a name='method-i-two_factor_auth_required_redirect'></a>
<div class='synopsis'>
<span class='name'>two_factor_auth_required_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_auth_required_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_auth_required_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 213</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_auth_required_redirect</span>&#x000A;  <span class="ruby-node">&quot;#{prefix}/#{otp_auth_route}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_authenticate'>
<a name='method-i-two_factor_authenticate'></a>
<div class='synopsis'>
<span class='name'>two_factor_authenticate</span>
<span class='arguments'>(type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_authenticate-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_authenticate-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 126</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_authenticate</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-identifier">two_factor_update_session</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-identifier">two_factor_remove_auth_failures</span>&#x000A;  <span class="ruby-identifier">after_two_factor_authentication</span>&#x000A;  <span class="ruby-identifier">set_notice_flash</span> <span class="ruby-identifier">two_factor_auth_notice_flash</span>&#x000A;  <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_auth_redirect</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_authenticated-3F'>
<a name='method-i-two_factor_authenticated-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_authenticated?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_authenticated-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_authenticated-3F-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 101</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_authenticated?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_session_key</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_authentication_setup-3F'>
<a name='method-i-two_factor_authentication_setup-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_authentication_setup?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_authentication_setup-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_authentication_setup-3F-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 205</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_authentication_setup?</span>&#x000A;  <span class="ruby-keyword">super</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">otp_exists?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_modifications_require_password-3F'>
<a name='method-i-two_factor_modifications_require_password-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_modifications_require_password?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_modifications_require_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_modifications_require_password-3F-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 34</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_modifications_require_password?</span>&#x000A;  <span class="ruby-identifier">modifications_require_password?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_need_setup_redirect'>
<a name='method-i-two_factor_need_setup_redirect'></a>
<div class='synopsis'>
<span class='name'>two_factor_need_setup_redirect</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_need_setup_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_need_setup_redirect-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 209</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_need_setup_redirect</span>&#x000A;  <span class="ruby-node">&quot;#{prefix}/#{otp_setup_route}&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_password_match-3F'>
<a name='method-i-two_factor_password_match-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_password_match?</span>
<span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_password_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_password_match-3F-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 93</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_password_match?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_modifications_require_password?</span>&#x000A;    <span class="ruby-identifier">password_match?</span>(<span class="ruby-identifier">password</span>)&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove'>
<a name='method-i-two_factor_remove'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 217</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-identifier">otp_remove</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove_auth_failures'>
<a name='method-i-two_factor_remove_auth_failures'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove_auth_failures</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove_auth_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove_auth_failures-source'><span class="ruby-comment"># File lib/rodauth/features/otp.rb, line 222</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove_auth_failures</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;  <span class="ruby-identifier">otp_remove_auth_failures</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove_session'>
<a name='method-i-two_factor_remove_session'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove_session-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 134</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove_session</span>&#x000A;  <span class="ruby-identifier">session</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">two_factor_session_key</span>)&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_setup_session_key</span>] = <span class="ruby-keyword">false</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_update_session'>
<a name='method-i-two_factor_update_session'></a>
<div class='synopsis'>
<span class='name'>two_factor_update_session</span>
<span class='arguments'>(type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_update_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_update_session-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 139</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_update_session</span>(<span class="ruby-identifier">type</span>)&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_session_key</span>] = <span class="ruby-identifier">type</span>&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_setup_session_key</span>] = <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unique_constraint_violation_class'>
<a name='method-i-unique_constraint_violation_class'></a>
<div class='synopsis'>
<span class='name'>unique_constraint_violation_class</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

<p>Work around jdbc/sqlite issue where it only raises ConstraintViolation and
not UniqueConstraintViolation.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unique_constraint_violation_class-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unique_constraint_violation_class-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 493</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unique_constraint_violation_class</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">adapter_scheme</span> <span class="ruby-operator">==</span> <span class="ruby-value">:jdbc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:sqlite</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">ConstraintViolation</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">UniqueConstraintViolation</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account'>
<a name='method-i-unlock_account'></a>
<div class='synopsis'>
<span class='name'>unlock_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 154</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account</span>&#x000A;  <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">remove_lockout_metadata</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account_email_body'>
<a name='method-i-unlock_account_email_body'></a>
<div class='synopsis'>
<span class='name'>unlock_account_email_body</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account_email_body-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 281</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account_email_body</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;unlock-account-email&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account_email_link'>
<a name='method-i-unlock_account_email_link'></a>
<div class='synopsis'>
<span class='name'>unlock_account_email_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account_email_link-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 219</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account_email_link</span>&#x000A;  <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">unlock_account_route</span>, <span class="ruby-identifier">unlock_account_key_param</span>, <span class="ruby-identifier">unlock_account_key_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account_email_recently_sent-3F'>
<a name='method-i-unlock_account_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>unlock_account_email_recently_sent?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account_email_recently_sent-3F-source'><span class="ruby-comment"># File lib/rodauth/features/lockout.rb, line 285</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account_email_recently_sent?</span>&#x000A;  (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_unlock_account_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">unlock_account_skip_resend_email_within</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_account'>
<a name='method-i-update_account'></a>
<div class='synopsis'>
<span class='name'>update_account</span>
<span class='arguments'>(values, ds=account_ds)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_account-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 533</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_account</span>(<span class="ruby-identifier">values</span>, <span class="ruby-identifier">ds</span>=<span class="ruby-identifier">account_ds</span>)&#x000A;  <span class="ruby-identifier">update_hash_ds</span>(<span class="ruby-identifier">account</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">values</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_activity'>
<a name='method-i-update_activity'></a>
<div class='synopsis'>
<span class='name'>update_activity</span>
<span class='arguments'>(account_id, *columns)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_activity-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_activity-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 112</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_activity</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">hash</span> = {}&#x000A;  <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">c</span>] = <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">hash</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">account_activity_id_column</span>] = <span class="ruby-identifier">account_id</span>&#x000A;    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">account_activity_last_activity_column</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>&#x000A;    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">account_activity_last_login_column</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>&#x000A;    <span class="ruby-comment"># It is safe to ignore uniqueness violations here, as a concurrent insert would also use current timestamps.</span>&#x000A;    <span class="ruby-identifier">ignore_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_hash_ds'>
<a name='method-i-update_hash_ds'></a>
<div class='synopsis'>
<span class='name'>update_hash_ds</span>
<span class='arguments'>(hash, ds, values)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_hash_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_hash_ds-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 523</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_hash_ds</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-identifier">num</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">num</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">account</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">?</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">v</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">num</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_last_activity'>
<a name='method-i-update_last_activity'></a>
<div class='synopsis'>
<span class='name'>update_last_activity</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_last_activity-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_last_activity-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 42</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_last_activity</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_value</span>&#x000A;    <span class="ruby-identifier">update_activity</span>(<span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">account_activity_last_activity_column</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_last_login'>
<a name='method-i-update_last_login'></a>
<div class='synopsis'>
<span class='name'>update_last_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_last_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_last_login-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 38</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_last_login</span>&#x000A;  <span class="ruby-identifier">update_activity</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_activity_last_login_column</span>, <span class="ruby-identifier">account_activity_last_activity_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_login'>
<a name='method-i-update_login'></a>
<div class='synopsis'>
<span class='name'>update_login</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_login-source'><span class="ruby-comment"># File lib/rodauth/features/change_login.rb, line 75</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_login</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">_update_login</span>(<span class="ruby-identifier">login</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_password_changed_at'>
<a name='method-i-update_password_changed_at'></a>
<div class='synopsis'>
<span class='name'>update_password_changed_at</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_password_changed_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_password_changed_at-source'><span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb, line 51</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_password_changed_at</span>&#x000A;  <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">password_expiration_ds</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">password_expiration_changed_at_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;    <span class="ruby-comment"># Ignoring the violation is safe here, since a concurrent insert would also set it to the</span>&#x000A;    <span class="ruby-comment"># current timestamp.</span>&#x000A;    <span class="ruby-identifier">ignore_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">password_expiration_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_password_hash-3F'>
<a name='method-i-update_password_hash-3F'></a>
<div class='synopsis'>
<span class='name'>update_password_hash?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_password_hash-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_password_hash-3F-source'><span class="ruby-comment"># File lib/rodauth/features/update_password_hash.rb, line 16</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_password_hash?</span>&#x000A;  <span class="ruby-identifier">password_hash_cost</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@current_password_hash_cost</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_session'>
<a name='method-i-update_session'></a>
<div class='synopsis'>
<span class='name'>update_session</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_session-source'><span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb, line 98</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_session</span>&#x000A;  <span class="ruby-identifier">check_account_expiration</span>&#x000A;  <span class="ruby-keyword">super</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_single_session_key'>
<a name='method-i-update_single_session_key'></a>
<div class='synopsis'>
<span class='name'>update_single_session_key</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_single_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_single_session_key-source'><span class="ruby-comment"># File lib/rodauth/features/single_session.rb, line 53</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_single_session_key</span>&#x000A;  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">random_key</span>&#x000A;  <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">single_session_session_key</span>, <span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">single_session_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">key</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;    <span class="ruby-comment"># Don&#39;t handle uniqueness violations here.  While we could get the stored key from the</span>&#x000A;    <span class="ruby-comment"># database, it could lead to two sessions sharing the same key, which this feature is</span>&#x000A;    <span class="ruby-comment"># designed to prevent.</span>&#x000A;    <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">single_session_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">single_session_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">key</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_sms'>
<a name='method-i-update_sms'></a>
<div class='synopsis'>
<span class='name'>update_sms</span>
<span class='arguments'>(values)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_sms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_sms-source'><span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb, line 492</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_sms</span>(<span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-identifier">update_hash_ds</span>(<span class="ruby-identifier">sms</span>, <span class="ruby-identifier">sms_ds</span>, <span class="ruby-identifier">values</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_database_authentication_functions-3F'>
<a name='method-i-use_database_authentication_functions-3F'></a>
<div class='synopsis'>
<span class='name'>use_database_authentication_functions?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_database_authentication_functions-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_database_authentication_functions-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 388</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_database_authentication_functions?</span>&#x000A;  <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span>&#x000A;  <span class="ruby-keyword">when</span> <span class="ruby-value">:postgres</span>, <span class="ruby-value">:mysql</span>, <span class="ruby-value">:mssql</span>&#x000A;    <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;    <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-comment"># :nocov:</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_date_arithmetic-3F'>
<a name='method-i-use_date_arithmetic-3F'></a>
<div class='synopsis'>
<span class='name'>use_date_arithmetic?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_date_arithmetic-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_date_arithmetic-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 380</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_date_arithmetic?</span>&#x000A;  <span class="ruby-identifier">set_deadline_values?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_jwt-3F'>
<a name='method-i-use_jwt-3F'></a>
<div class='synopsis'>
<span class='name'>use_jwt?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_jwt-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_jwt-3F-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 132</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_jwt?</span>&#x000A;  <span class="ruby-identifier">jwt_token</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">only_json?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">json_request?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_multi_phase_login-3F'>
<a name='method-i-use_multi_phase_login-3F'></a>
<div class='synopsis'>
<span class='name'>use_multi_phase_login?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_multi_phase_login-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_multi_phase_login-3F-source'><span class="ruby-comment"># File lib/rodauth/features/email_auth.rb, line 172</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_multi_phase_login?</span>&#x000A;  <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_request_specific_csrf_tokens-3F'>
<a name='method-i-use_request_specific_csrf_tokens-3F'></a>
<div class='synopsis'>
<span class='name'>use_request_specific_csrf_tokens?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_request_specific_csrf_tokens-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_request_specific_csrf_tokens-3F-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 399</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_request_specific_csrf_tokens?</span>&#x000A;  <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_csrf</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:route_csrf</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">use_request_specific_csrf_tokens?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-uses_two_factor_authentication-3F'>
<a name='method-i-uses_two_factor_authentication-3F'></a>
<div class='synopsis'>
<span class='name'>uses_two_factor_authentication?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-uses_two_factor_authentication-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-uses_two_factor_authentication-3F-source'><span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb, line 109</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">uses_two_factor_authentication?</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_setup_session_key</span>] = <span class="ruby-identifier">two_factor_authentication_setup?</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">two_factor_setup_session_key</span>)&#x000A;  <span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_setup_session_key</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-valid_jwt-3F'>
<a name='method-i-valid_jwt-3F'></a>
<div class='synopsis'>
<span class='name'>valid_jwt?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-valid_jwt-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-valid_jwt-3F-source'><span class="ruby-comment"># File lib/rodauth/features/jwt.rb, line 136</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">valid_jwt?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">jwt_token</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">jwt_payload</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verified_account-3F'>
<a name='method-i-verified_account-3F'></a>
<div class='synopsis'>
<span class='name'>verified_account?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verified_account-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verified_account-3F-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb, line 16</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verified_account?</span>&#x000A;  <span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">unverified_account_session_key</span>]&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account'>
<a name='method-i-verify_account'></a>
<div class='synopsis'>
<span class='name'>verify_account</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 163</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account</span>&#x000A;  <span class="ruby-identifier">update_account</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_open_status_value</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_check_already_logged_in'>
<a name='method-i-verify_account_check_already_logged_in'></a>
<div class='synopsis'>
<span class='name'>verify_account_check_already_logged_in</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_check_already_logged_in-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_check_already_logged_in-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 271</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_check_already_logged_in</span>&#x000A;  <span class="ruby-identifier">check_already_logged_in</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_ds'>
<a name='method-i-verify_account_ds'></a>
<div class='synopsis'>
<span class='name'>verify_account_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_ds-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 304</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">verify_account_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">verify_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_body'>
<a name='method-i-verify_account_email_body'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_body</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_body-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 300</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_body</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;verify-account-email&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_link'>
<a name='method-i-verify_account_email_link'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_link-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 201</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_link</span>&#x000A;  <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">verify_account_route</span>, <span class="ruby-identifier">verify_account_key_param</span>, <span class="ruby-identifier">verify_account_key_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_recently_sent-3F'>
<a name='method-i-verify_account_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_recently_sent?</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_recently_sent-3F-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 244</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_recently_sent?</span>&#x000A;  (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_verify_account_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">verify_account_skip_resend_email_within</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_resend'>
<a name='method-i-verify_account_email_resend'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_resend</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_resend-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_resend-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 167</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_resend</span>&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@verify_account_key_value</span> = <span class="ruby-identifier">get_verify_account_key</span>(<span class="ruby-identifier">account_id</span>)&#x000A;    <span class="ruby-identifier">set_verify_account_email_last_sent</span>&#x000A;    <span class="ruby-identifier">send_verify_account_email</span>&#x000A;    <span class="ruby-keyword">true</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_key_insert_hash'>
<a name='method-i-verify_account_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>verify_account_key_insert_hash</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_key_insert_hash-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 292</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_key_insert_hash</span>&#x000A;  {<span class="ruby-identifier">verify_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">verify_account_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">verify_account_key_value</span>}&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_resend_link'>
<a name='method-i-verify_account_resend_link'></a>
<div class='synopsis'>
<span class='name'>verify_account_resend_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_resend_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_resend_link-source'><span class="ruby-comment"># File lib/rodauth/features/verify_account.rb, line 221</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_resend_link</span>&#x000A;  <span class="ruby-node">&quot;&lt;p&gt;&lt;a href=\&quot;#{prefix}/#{verify_account_resend_route}\&quot;&gt;Resend Verify Account Information&lt;/a&gt;&lt;/p&gt;&quot;</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change'>
<a name='method-i-verify_login_change'></a>
<div class='synopsis'>
<span class='name'>verify_login_change</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 105</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change</span>&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">res</span> = <span class="ruby-identifier">_update_login</span>(<span class="ruby-identifier">verify_login_change_new_login</span>)&#x000A;    <span class="ruby-identifier">remove_verify_login_change_key</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;&#x000A;  <span class="ruby-identifier">res</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_ds'>
<a name='method-i-verify_login_change_ds'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_ds</span>
<span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_ds-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 199</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)&#x000A;  <span class="ruby-identifier">db</span>[<span class="ruby-identifier">verify_login_change_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">verify_login_change_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_email_body'>
<a name='method-i-verify_login_change_email_body'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_email_body</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_email_body-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 195</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_email_body</span>&#x000A;  <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;verify-login-change-email&#39;</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_email_link'>
<a name='method-i-verify_login_change_email_link'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_email_link</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_email_link-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 121</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_email_link</span>&#x000A;  <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">verify_login_change_route</span>, <span class="ruby-identifier">verify_login_change_key_param</span>, <span class="ruby-identifier">verify_login_change_key_value</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_key_insert_hash'>
<a name='method-i-verify_login_change_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_key_insert_hash</span>
<span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_key_insert_hash-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 185</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_key_insert_hash</span>(<span class="ruby-identifier">login</span>)&#x000A;  <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">verify_login_change_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">verify_login_change_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">verify_login_change_key_value</span>, <span class="ruby-identifier">verify_login_change_login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>}&#x000A;  <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">verify_login_change_deadline_column</span>, <span class="ruby-identifier">verify_login_change_deadline_interval</span>)&#x000A;  <span class="ruby-identifier">hash</span>&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_old_login'>
<a name='method-i-verify_login_change_old_login'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_old_login</span>
<span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_old_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_old_login-source'><span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb, line 133</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_old_login</span>&#x000A;  <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">login_column</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-view'>
<a name='method-i-view'></a>
<div class='synopsis'>
<span class='name'>view</span>
<span class='arguments'>(page, title)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-view-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-view-source'><span class="ruby-comment"># File lib/rodauth/features/base.rb, line 264</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">view</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">title</span>)&#x000A;  <span class="ruby-identifier">set_title</span>(<span class="ruby-identifier">title</span>)&#x000A;  <span class="ruby-identifier">_view</span>(<span class="ruby-value">:view</span>, <span class="ruby-identifier">page</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/rdoc/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
